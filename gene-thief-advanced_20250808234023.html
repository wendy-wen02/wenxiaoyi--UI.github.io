<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gene Thief — Advanced Biochemical Visualization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #a00;
            overflow: hidden;
            position: relative;
            cursor: none;
        }
        
        /* 生物血管纹理背景 - 增强恐怖感 */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at 20% 30%, rgba(80, 0, 0, 0.6) 0%, transparent 40%),
                radial-gradient(ellipse at 80% 70%, rgba(40, 0, 20, 0.7) 0%, transparent 40%),
                radial-gradient(ellipse at 50% 50%, rgba(0, 0, 0, 0.95) 0%, transparent 100%),
                repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(60,0,0,0.1) 10px, rgba(60,0,0,0.1) 20px),
                repeating-linear-gradient(-45deg, transparent, transparent 15px, rgba(40,0,20,0.1) 15px, rgba(40,0,20,0.1) 30px);
            z-index: 0;
            animation: bloodPulse 4s ease-in-out infinite;
            filter: contrast(1.2) brightness(0.8);
        }
        
        /* 有机组织层 */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 30% 40%, rgba(50,0,0,0.4) 0%, transparent 20%),
                radial-gradient(circle at 70% 60%, rgba(30,0,10,0.4) 0%, transparent 25%),
                radial-gradient(circle at 50% 80%, rgba(40,0,0,0.3) 0%, transparent 30%);
            z-index: 0;
            animation: organicMove 15s ease-in-out infinite;
            pointer-events: none;
            mix-blend-mode: multiply;
        }
        
        @keyframes bloodPulse {
            0%, 100% { 
                opacity: 0.6;
                filter: contrast(1.2) brightness(0.8) hue-rotate(0deg);
            }
            50% { 
                opacity: 0.9;
                filter: contrast(1.5) brightness(0.6) hue-rotate(-10deg);
            }
        }
        
        @keyframes organicMove {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(5deg); }
            50% { transform: scale(0.95) rotate(-3deg); }
            75% { transform: scale(1.05) rotate(2deg); }
        }

        /* 自定义光标 - 血色 */
        .cursor {
            position: fixed;
            width: 20px;
            height: 20px;
            border: 2px solid #f00;
            border-radius: 50%;
            pointer-events: none;
            z-index: 10000;
            transition: transform 0.1s;
            mix-blend-mode: screen;
            box-shadow: 0 0 20px rgba(255,0,0,0.5);
        }

        .cursor::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 5px;
            height: 5px;
            background: #a00;
            border-radius: 50%;
            box-shadow: 0 0 20px #a00;
        }

        .cursor.clicking {
            transform: scale(0.8);
            border-color: #ff0;
        }

        .cursor-trail {
            position: fixed;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, rgba(0,255,255,0.5) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            animation: fadeOut 1s forwards;
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: scale(2);
            }
        }

        #canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            background: 
                radial-gradient(ellipse at center, #0a0000 0%, #000 70%),
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><filter id="noise"><feTurbulence baseFrequency="0.9" numOctaves="4" /></filter><rect width="100" height="100" filter="url(%23noise)" opacity="0.05"/></svg>');
            filter: contrast(1.1) saturate(0.8);
        }

        /* 黑洞容器 */
        .blackhole-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 400px;
            z-index: 5;
            pointer-events: none;
        }

        .blackhole {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            background: radial-gradient(circle at center, 
                rgba(0,0,0,1) 0%, 
                rgba(20,0,0,0.9) 30%, 
                rgba(139,0,0,0.4) 60%, 
                rgba(138,43,226,0.2) 80%,
                transparent 100%);
            border-radius: 50%;
            animation: blackholePulse 4s ease-in-out infinite;
            filter: blur(2px);
            box-shadow: 
                inset 0 0 50px rgba(139,0,0,0.5),
                0 0 100px rgba(75,0,130,0.3);
        }

        @keyframes blackholePulse {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1); 
                filter: blur(2px);
            }
            50% { 
                transform: translate(-50%, -50%) scale(1.1); 
                filter: blur(4px);
            }
        }

        .event-horizon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border: 2px solid rgba(138,43,226,0.5);
            border-radius: 50%;
            animation: eventHorizonRotate 10s linear infinite;
            box-shadow: 
                0 0 50px rgba(138,43,226,0.5),
                inset 0 0 50px rgba(138,43,226,0.3);
        }

        @keyframes eventHorizonRotate {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .accretion-disk {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotateX(60deg);
            width: 350px;
            height: 350px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, 
                transparent, 
                rgba(0,255,255,0.1), 
                rgba(138,43,226,0.2), 
                rgba(255,0,255,0.1), 
                transparent);
            animation: diskRotate 5s linear infinite;
            filter: blur(1px);
        }

        @keyframes diskRotate {
            0% { transform: translate(-50%, -50%) rotateX(60deg) rotateZ(0deg); }
            100% { transform: translate(-50%, -50%) rotateX(60deg) rotateZ(360deg); }
        }

        /* 雾化效果层 */
        .fog-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 4;
            opacity: 0.6;
            mix-blend-mode: screen;
        }

        .fog {
            position: absolute;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle at center, 
                rgba(0,255,255,0.1) 0%, 
                transparent 50%);
            filter: blur(40px);
            animation: fogFloat 20s ease-in-out infinite;
        }

        @keyframes fogFloat {
            0%, 100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.3;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0.6;
            }
        }

        /* 主控制面板 - 增强版 */
        .control-panel {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 350px;
            background: 
                linear-gradient(135deg, rgba(20,0,10,0.95) 0%, rgba(0,10,30,0.95) 100%),
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><rect width="100" height="100" fill="black"/><circle cx="50" cy="50" r="40" fill="none" stroke="rgba(139,0,0,0.1)" stroke-width="0.5"/></svg>');
            border: 1px solid rgba(139,0,0,0.6);
            border-left: 3px solid rgba(255,0,0,0.3);
            padding: 20px;
            z-index: 1000;
            box-shadow: 
                0 0 30px rgba(139,0,0,0.3), 
                inset 0 0 20px rgba(75,0,130,0.1),
                inset -2px 0 10px rgba(255,0,0,0.2);
            backdrop-filter: blur(10px) saturate(0.8);
            animation: panelGlow 3s ease-in-out infinite;
            transition: transform 0.3s;
        }

        .control-panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 40px rgba(0,255,255,0.5), inset 0 0 30px rgba(0,255,255,0.2);
        }

        .panel-header {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0,255,255,0.3);
            color: #f88;
            text-shadow: 0 0 10px rgba(0,255,255,0.8);
            position: relative;
        }

        .panel-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, #a00, transparent);
            animation: scanLine 3s linear infinite;
        }

        @keyframes scanLine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* 阶段指示器 - 增强版 */
        .phase-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
        }

        .phase {
            flex: 1;
            text-align: center;
            padding: 10px;
            background: rgba(0,50,100,0.3);
            border: 1px solid rgba(0,255,255,0.2);
            font-size: 10px;
            text-transform: uppercase;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .phase:hover {
            background: rgba(0,100,150,0.4);
            transform: scale(1.05);
        }

        .phase.active {
            background: rgba(0,255,255,0.2);
            border-color: #0ff;
            box-shadow: 0 0 20px rgba(0,255,255,0.5);
            animation: phaseGlow 1s ease-in-out infinite;
        }

        @keyframes phaseGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(0,255,255,0.5); }
            50% { box-shadow: 0 0 40px rgba(0,255,255,0.8); }
        }

        /* 数据监控 - 增强版 */
        .monitor-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .monitor-item {
            background: rgba(0,20,40,0.5);
            border: 1px solid rgba(0,255,255,0.3);
            padding: 10px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
        }

        .monitor-item:hover {
            background: rgba(0,40,80,0.6);
            border-color: #0ff;
            transform: scale(1.02);
        }

        .monitor-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,255,255,0.2), transparent);
            animation: monitorScan 3s linear infinite;
        }

        @keyframes monitorScan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .monitor-label {
            font-size: 9px;
            text-transform: uppercase;
            color: rgba(0,255,255,0.6);
            margin-bottom: 5px;
        }

        .monitor-value {
            font-size: 18px;
            font-weight: bold;
            color: #f88;
            text-shadow: 0 0 5px rgba(0,255,255,0.8);
            transition: all 0.3s;
        }

        .monitor-item:hover .monitor-value {
            transform: scale(1.1);
            text-shadow: 0 0 10px rgba(0,255,255,1);
        }

        /* 控制按钮 - 增强版 */
        .control-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .control-btn {
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, rgba(0,100,200,0.3) 0%, rgba(0,50,150,0.3) 100%);
            border: 1px solid #0ff;
            color: #f88;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 11px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .control-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(0,255,255,0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .control-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .control-btn:hover {
            background: linear-gradient(135deg, rgba(0,150,255,0.4) 0%, rgba(0,100,200,0.4) 100%);
            box-shadow: 0 0 30px rgba(0,255,255,0.6);
            transform: translateY(-3px);
            z-index: 1;
        }

        .control-btn:active {
            transform: translateY(0);
        }

        .control-btn.active {
            background: linear-gradient(135deg, rgba(0,255,0,0.3) 0%, rgba(0,200,0,0.3) 100%);
            border-color: #0f0;
            color: #0f0;
        }

        /* 新模块样式 */
        .sample-info-module,
        .gene-extract-module,
        .blackmarket-module {
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(0,20,40,0.6);
            border: 1px solid rgba(0,255,255,0.2);
            border-left: 3px solid rgba(255,0,0,0.5);
        }

        .module-title {
            font-size: 11px;
            text-transform: uppercase;
            color: #00ffff;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(0,255,255,0.3);
        }

        .sample-item,
        .param-item,
        .value-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding: 5px 0;
            font-size: 10px;
        }

        .sample-label,
        .param-label,
        .value-label {
            color: rgba(0,255,255,0.7);
            text-transform: uppercase;
        }

        /* 故障文字效果 */
        .glitch-text {
            position: relative;
            color: #ff6666;
            font-family: 'Courier New', monospace;
        }

        .glitch-text::before,
        .glitch-text::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .glitch-text::before {
            animation: glitch-1 2s infinite linear alternate-reverse;
            color: #ff0000;
            z-index: -1;
            opacity: 0.8;
        }

        .glitch-text::after {
            animation: glitch-2 2s infinite linear alternate-reverse;
            color: #00ffff;
            z-index: -2;
            opacity: 0.8;
        }

        @keyframes glitch-1 {
            0% { clip: rect(44px, 9999px, 56px, 0); }
            25% { clip: rect(20px, 9999px, 30px, 0); }
            50% { clip: rect(70px, 9999px, 80px, 0); }
            75% { clip: rect(2px, 9999px, 8px, 0); }
            100% { clip: rect(85px, 9999px, 90px, 0); }
        }

        @keyframes glitch-2 {
            0% { clip: rect(65px, 9999px, 70px, 0); transform: translateX(2px); }
            25% { clip: rect(15px, 9999px, 20px, 0); transform: translateX(-2px); }
            50% { clip: rect(40px, 9999px, 45px, 0); transform: translateX(2px); }
            75% { clip: rect(80px, 9999px, 85px, 0); transform: translateX(-1px); }
            100% { clip: rect(25px, 9999px, 30px, 0); transform: translateX(1px); }
        }

        /* 采集部位图标 */
        .collection-site {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .site-icon {
            font-size: 14px;
            opacity: 0.3;
            cursor: pointer;
            transition: all 0.3s;
        }

        .site-icon.active {
            opacity: 1;
            filter: drop-shadow(0 0 5px rgba(255,100,100,0.8));
            transform: scale(1.2);
        }

        .site-text {
            font-size: 9px;
            color: #ff6666;
            margin-left: 5px;
        }

        /* 样本状态灯 */
        .sample-status {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-light {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #333;
        }

        .status-light.active {
            background: #00ff00;
            box-shadow: 0 0 8px rgba(0,255,0,0.8);
            animation: statusPulse 2s infinite;
        }

        @keyframes statusPulse {
            0%, 100% { box-shadow: 0 0 8px rgba(0,255,0,0.8); }
            50% { box-shadow: 0 0 15px rgba(0,255,0,1); }
        }

        /* 垂直进度条 */
        .collection-progress {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .progress-bar-vertical {
            width: 6px;
            height: 35px;
            background: rgba(0,50,100,0.3);
            border: 1px solid rgba(0,255,255,0.3);
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 73%;
            background: linear-gradient(0deg, #ff0066, #ff6600, #ffff00);
            transition: height 0.5s ease;
        }

        .particle-stream {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .particle-stream::before {
            content: '';
            position: absolute;
            width: 2px;
            height: 2px;
            background: #00ffff;
            border-radius: 50%;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            animation: particleFloat 2s infinite;
        }

        @keyframes particleFloat {
            0% { bottom: 0; opacity: 1; }
            100% { bottom: 100%; opacity: 0; }
        }

        .progress-text {
            font-size: 11px;
            color: #ff6666;
            font-weight: bold;
        }

        /* 圆环进度 */
        .purity-display {
            position: relative;
        }

        .circular-progress {
            position: relative;
            width: 60px;
            height: 60px;
        }

        .circular-progress svg {
            transform: rotate(-90deg);
        }

        .progress-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 10px;
            color: #00ffff;
            font-weight: bold;
        }

        /* 活性评分 */
        .activity-score {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .score-value.heartbeat {
            color: #00ffff;
            font-size: 14px;
            font-weight: bold;
            animation: heartbeat 1.5s infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); color: #00ffff; }
            50% { transform: scale(1.1); color: #ff6600; }
        }

        .pulse-indicator {
            width: 6px;
            height: 6px;
            background: #ff0000;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.5; }
        }

        /* DNA/RNA分离条 */
        .separation-bar {
            display: flex;
            width: 100px;
            height: 16px;
            border: 1px solid rgba(0,255,255,0.3);
            overflow: hidden;
        }

        .separation-dna {
            background: linear-gradient(90deg, #0066ff, #0099ff);
            color: #fff;
            font-size: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .separation-rna {
            background: linear-gradient(90deg, #ff6600, #ff9900);
            color: #fff;
            font-size: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .separation-text {
            font-size: 9px;
            color: #00ffff;
            margin-top: 2px;
        }

        /* 黑市价值样式 */
        .market-price {
            display: flex;
            align-items: baseline;
        }

        .price-symbol {
            color: #00ff00;
            font-size: 12px;
        }

        .price-value.neon-glitch {
            color: #00ff00;
            font-size: 14px;
            font-weight: bold;
            text-shadow: 0 0 8px rgba(0,255,0,0.8);
            animation: neonFlicker 2s infinite;
        }

        @keyframes neonFlicker {
            0%, 100% { text-shadow: 0 0 8px rgba(0,255,0,0.8); }
            50% { text-shadow: 0 0 15px rgba(0,255,0,1), 0 0 20px rgba(255,255,0,0.5); }
        }

        /* 需求热度 */
        .demand-heatmap {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .heatmap-bar {
            display: flex;
            gap: 1px;
        }

        .heat-segment {
            width: 12px;
            height: 16px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .heat-segment.low { background: #003366; }
        .heat-segment.medium { background: #ff6600; }
        .heat-segment.high { background: #ff3300; }
        .heat-segment.critical { background: #ff0000; }

        .heat-segment.active {
            animation: heatGlow 2s infinite;
        }

        @keyframes heatGlow {
            0%, 100% { box-shadow: 0 0 3px rgba(255,0,0,0.5); }
            50% { box-shadow: 0 0 10px rgba(255,0,0,0.8); }
        }

        .demand-text {
            font-size: 9px;
            color: #ff3300;
            font-weight: bold;
        }

        /* 风险级别 */
        .risk-indicator {
            display: flex;
            align-items: center;
            gap: 3px;
            padding: 3px 6px;
            border-radius: 2px;
            font-size: 9px;
        }

        .risk-indicator.medium {
            background: rgba(100,50,0,0.3);
            color: #ff9900;
            border: 1px solid #ff9900;
        }

        .warning-icon {
            font-size: 10px;
            animation: warningBlink 1.5s infinite;
        }

        @keyframes warningBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* 高级控制滑块 */
        .slider-control {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0,20,40,0.5);
            border: 1px solid rgba(0,255,255,0.3);
        }

        .slider-label {
            font-size: 10px;
            text-transform: uppercase;
            color: rgba(0,255,255,0.8);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }

        .slider {
            width: 100%;
            height: 6px;
            background: rgba(0,50,100,0.5);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
            position: relative;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: #0ff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 20px #0ff;
            transition: all 0.3s;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 30px #0ff;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #0ff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 20px #0ff;
            border: none;
        }




        /* 状态指示器 - 增强版 */
        .status-indicators {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .status-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            background: rgba(0,20,40,0.8);
            padding: 10px 15px;
            border: 1px solid rgba(0,255,255,0.3);
            transition: all 0.3s;
            cursor: pointer;
        }

        .status-item:hover {
            background: rgba(0,40,80,0.9);
            border-color: #0ff;
            transform: translateX(-5px);
        }

        .status-light {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
            animation: pulse 2s ease-in-out infinite;
        }

        .status-light.active {
            background: #0ff;
            box-shadow: 0 0 15px #0ff;
        }

        .status-light.warning {
            background: #ff0;
            box-shadow: 0 0 15px #ff0;
            animation: warningBlink 1s ease-in-out infinite;
        }

        @keyframes warningBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .status-light.error {
            background: #f00;
            box-shadow: 0 0 15px #f00;
            animation: errorPulse 0.5s ease-in-out infinite;
        }

        @keyframes errorPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* 交互提示 */
        .interaction-hint {
            position: fixed;
            bottom: 140px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,20,40,0.9);
            border: 1px solid rgba(0,255,255,0.5);
            padding: 10px 20px;
            font-size: 12px;
            color: rgba(0,255,255,0.8);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .interaction-hint.show {
            opacity: 1;
        }

        /* 波纹效果 */
        .ripple {
            position: absolute;
            border-radius: 50%;
            border: 2px solid rgba(0,255,255,0.5);
            animation: rippleExpand 1s ease-out forwards;
            pointer-events: none;
            z-index: 100;
        }

        @keyframes rippleExpand {
            0% {
                width: 0;
                height: 0;
                opacity: 1;
            }
            100% {
                width: 200px;
                height: 200px;
                opacity: 0;
            }
        }

        /* 扫描线效果 */
        .scanline {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #a00, transparent);
            opacity: 0.5;
            animation: scan 3s linear infinite;
            z-index: 999;
            pointer-events: none;
        }

        @keyframes scan {
            0% { top: -2px; }
            100% { top: 100%; }
        }

        /* 网格背景 */
        .grid-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(rgba(0,255,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,255,255,0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 2;
            animation: gridMove 10s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        /* 全屏模式按钮 */
        .fullscreen-btn {
            position: fixed;
            top: 20px;
            right: 400px;
            width: 40px;
            height: 40px;
            background: rgba(0,20,40,0.8);
            border: 1px solid #0ff;
            color: #f88;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s;
            z-index: 1000;
        }

        .fullscreen-btn:hover {
            background: rgba(0,40,80,0.9);
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(0,255,255,0.5);
        }

        /* 音频可视化 */
        .audio-visualizer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 2px;
            padding: 0 20px;
            z-index: 500;
            pointer-events: none;
        }

        .audio-bar {
            flex: 1;
            max-width: 10px;
            background: linear-gradient(180deg, #0ff 0%, #00f 100%);
            opacity: 0.6;
            animation: audioWave 1s ease-in-out infinite;
            transform-origin: bottom;
        }

        @keyframes audioWave {
            0%, 100% { height: 5px; }
            50% { height: 30px; }
        }

        /* 粒子轨迹 */
        .particle-trail {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #0ff;
            border-radius: 50%;
            pointer-events: none;
            z-index: 50;
        }

        /* 加载动画 */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            transition: opacity 1s;
        }

        .loading-content {
            text-align: center;
        }

        .loading-text {
            font-size: 24px;
            color: #f88;
            text-transform: uppercase;
            letter-spacing: 4px;
            animation: loadingPulse 1.5s ease-in-out infinite;
            margin-bottom: 30px;
        }

        @keyframes loadingPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .loading-bar {
            width: 300px;
            height: 4px;
            background: rgba(0,50,100,0.5);
            border-radius: 2px;
            overflow: hidden;
            margin: 0 auto;
        }

        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, #0ff, #00f);
            border-radius: 2px;
            animation: loadingProgress 2s ease-out forwards;
        }

        @keyframes loadingProgress {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        
        /* 生物危险警告系统 */
        .biohazard-warning {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            padding: 30px;
            background: rgba(139,0,0,0.9);
            border: 2px solid #f00;
            border-radius: 10px;
            z-index: 5000;
            display: none;
            animation: warningFlash 0.5s ease-in-out infinite;
        }
        
        @keyframes warningFlash {
            0%, 100% { 
                box-shadow: 0 0 50px rgba(255,0,0,0.8);
                background: rgba(139,0,0,0.9);
            }
            50% { 
                box-shadow: 0 0 100px rgba(255,0,0,1);
                background: rgba(200,0,0,0.95);
            }
        }
        
        .warning-title {
            font-size: 24px;
            color: #fff;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 20px rgba(255,0,0,1);
        }
        
        .warning-message {
            color: #faa;
            text-align: center;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* 提取进度条 */
        .extraction-progress {
            position: fixed;
            bottom: 130px;
            left: 20px;
            right: 20px;
            height: 40px;
            background: rgba(0,0,0,0.8);
            border: 1px solid rgba(139,0,0,0.5);
            padding: 10px;
            z-index: 1000;
            display: none;
        }
        
        .progress-label {
            font-size: 10px;
            color: rgba(255,100,100,0.8);
            margin-bottom: 5px;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(50,0,0,0.5);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #800, #f00, #800);
            border-radius: 5px;
            transition: width 0.3s;
            animation: progressPulse 1s ease-in-out infinite;
        }
        
        @keyframes progressPulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        /* 结果面板 */
        .result-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 500px;
            max-height: 600px;
            background: rgba(0,0,0,0.95);
            border: 2px solid rgba(0,255,0,0.5);
            padding: 30px;
            z-index: 4000;
            display: none;
            overflow-y: auto;
        }
        
        .result-title {
            font-size: 18px;
            color: #0f0;
            margin-bottom: 20px;
            text-align: center;
            text-transform: uppercase;
        }
        
        .result-data {
            font-family: monospace;
            font-size: 12px;
            color: #f88;
            line-height: 1.8;
            white-space: pre-wrap;
        }
        
        .result-close {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: rgba(255,0,0,0.2);
            border: 1px solid #f00;
            color: #f00;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .result-close:hover {
            background: rgba(255,0,0,0.5);
            transform: rotate(90deg);
        }
        
        /* 音频反馈提示 */
        .audio-feedback {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(0,50,0,0.8);
            border: 1px solid #0f0;
            border-radius: 5px;
            color: #0f0;
            font-size: 12px;
            z-index: 2000;
            display: none;
            animation: slideInRight 0.5s ease-out;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* 污染指示器 */
        .contamination-indicator {
            position: fixed;
            top: 100px;
            right: 20px;
            width: 200px;
            padding: 15px;
            background: rgba(50,0,0,0.8);
            border: 1px solid rgba(255,0,0,0.5);
            z-index: 1000;
        }
        
        .contamination-level {
            font-size: 12px;
            color: #f88;
            margin-bottom: 10px;
        }
        
        .contamination-bar {
            width: 100%;
            height: 20px;
            background: linear-gradient(90deg, 
                #0f0 0%, #0f0 20%,
                #ff0 20%, #ff0 40%,
                #f80 40%, #f80 60%,
                #f00 60%, #f00 80%,
                #800 80%, #800 100%);
            border: 1px solid #555;
            position: relative;
        }
        
        .contamination-marker {
            position: absolute;
            top: -5px;
            width: 2px;
            height: 30px;
            background: #fff;
            left: 10%;
            transition: left 0.5s;
            box-shadow: 0 0 10px #fff;
        }
        /* 血管网络 */
        .vein-network {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 3;
            opacity: 0.4;
        }
        
        .vein {
            position: absolute;
            background: linear-gradient(90deg, transparent, rgba(80,0,0,0.6), transparent);
            height: 2px;
            transform-origin: left center;
            animation: veinPulse 3s ease-in-out infinite;
        }
        
        @keyframes veinPulse {
            0%, 100% { 
                opacity: 0.3;
                filter: blur(1px);
            }
            50% { 
                opacity: 0.7;
                filter: blur(0px);
            }
        }
        
        /* 有机粘液效果 */
        .slime-drip {
            position: fixed;
            width: 20px;
            height: 100px;
            background: linear-gradient(180deg, 
                transparent 0%, 
                rgba(40,60,0,0.6) 20%,
                rgba(60,80,0,0.8) 80%,
                rgba(80,100,0,1) 100%);
            border-radius: 50% 50% 50% 50% / 10% 10% 90% 90%;
            animation: drip 8s ease-in-out infinite;
            z-index: 4;
            filter: blur(2px);
        }
        
        @keyframes drip {
            0% { 
                transform: translateY(-100px) scaleY(0.5);
                opacity: 0;
            }
            20% {
                opacity: 0.8;
            }
            100% { 
                transform: translateY(100vh) scaleY(1.5);
                opacity: 0;
            }
        }
        
        /* 腐败效果 */
        .decay-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
            background: 
                radial-gradient(circle at 20% 20%, rgba(40,60,0,0.2) 0%, transparent 30%),
                radial-gradient(circle at 80% 80%, rgba(60,40,0,0.2) 0%, transparent 30%),
                radial-gradient(circle at 60% 40%, rgba(50,30,0,0.15) 0%, transparent 40%);
            animation: decay 20s ease-in-out infinite;
            mix-blend-mode: color-burn;
        }
        
        @keyframes decay {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }
        
        /* 触手/触须效果 - 增强 */
        .tentacle {
            position: fixed;
            width: 60px;
            height: 350px;
            background: linear-gradient(180deg,
                rgba(60,0,30,0) 0%,
                rgba(100,20,40,0.6) 30%,
                rgba(120,10,50,0.8) 60%,
                rgba(140,0,60,1) 100%);
            border-radius: 50% 50% 50% 50% / 5% 5% 95% 95%;
            transform-origin: top center;
            animation: tentacleWave 6s ease-in-out infinite;
            z-index: 3;
            filter: blur(1px) brightness(1.2);
            opacity: 0.8;
            box-shadow: 0 0 30px rgba(200,0,50,0.4);
        }
        
        @keyframes tentacleWave {
            0%, 100% { 
                transform: rotate(-10deg) scaleX(1) translateY(0);
            }
            25% { 
                transform: rotate(5deg) scaleX(1.1) translateY(-10px);
            }
            50% { 
                transform: rotate(-5deg) scaleX(0.9) translateY(5px);
            }
            75% { 
                transform: rotate(10deg) scaleX(1.05) translateY(-5px);
            }
        }
        
        /* 眼球监视器 */
        .bio-eye {
            position: fixed;
            width: 80px;
            height: 80px;
            border-radius: 50% 40% 50% 40%;
            background: radial-gradient(circle at 35% 35%,
                #fff 5%,
                #f88 10%,
                #800 25%,
                #400 40%,
                #200 60%,
                #000 100%);
            box-shadow: 
                inset 0 0 20px rgba(0,0,0,0.8),
                0 0 40px rgba(200,0,0,0.5);
            z-index: 5;
            animation: eyeLook 8s ease-in-out infinite;
        }
        
        .eye-pupil {
            position: absolute;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle,
                #000 40%,
                #200 60%,
                #400 100%);
            border-radius: 50%;
            top: 25px;
            left: 25px;
            animation: pupilMove 4s ease-in-out infinite;
        }
        
        @keyframes eyeLook {
            0%, 100% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(-10deg) scale(1.05); }
            50% { transform: rotate(5deg) scale(0.95); }
            75% { transform: rotate(-5deg) scale(1.02); }
        }
        
        @keyframes pupilMove {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(5px, -5px); }
            50% { transform: translate(-5px, 5px); }
            75% { transform: translate(3px, 3px); }
        }
        
        /* 肿瘤/脓包 */
        .tumor {
            position: fixed;
            width: 120px;
            height: 100px;
            border-radius: 60% 40% 50% 50%;
            background: radial-gradient(ellipse at 30% 30%,
                rgba(200,100,50,0.8) 0%,
                rgba(150,50,30,0.9) 30%,
                rgba(100,30,20,1) 60%,
                rgba(60,20,10,1) 100%);
            box-shadow: 
                inset -10px -10px 30px rgba(0,0,0,0.5),
                inset 5px 5px 20px rgba(200,100,50,0.3),
                0 0 30px rgba(150,50,0,0.4);
            animation: tumorPulse 5s ease-in-out infinite;
            z-index: 4;
            filter: contrast(1.2);
        }
        
        @keyframes tumorPulse {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                filter: brightness(1) contrast(1.2);
            }
            25% { 
                transform: scale(1.1) rotate(2deg);
                filter: brightness(1.1) contrast(1.3);
            }
            50% { 
                transform: scale(1.05) rotate(-1deg);
                filter: brightness(0.9) contrast(1.4);
            }
            75% { 
                transform: scale(1.08) rotate(1deg);
                filter: brightness(1.05) contrast(1.2);
            }
        }
        
        /* 血丝纹理 */
        .blood-vessel {
            position: fixed;
            width: 2px;
            height: 100px;
            background: linear-gradient(180deg,
                transparent 0%,
                rgba(200,0,0,0.6) 20%,
                rgba(150,0,0,0.8) 50%,
                rgba(200,0,0,0.6) 80%,
                transparent 100%);
            transform-origin: top center;
            animation: vesselPulse 2s ease-in-out infinite;
            z-index: 3;
        }
        
        @keyframes vesselPulse {
            0%, 100% { 
                opacity: 0.6;
                transform: scaleY(1);
            }
            50% { 
                opacity: 1;
                transform: scaleY(1.1);
            }
        }
        
        /* 筋膜组织 */
        /* 暂停界面样式 - 克苏鲁风格 */
        .pause-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at 30% 40%, rgba(20,0,30,0.9) 0%, transparent 40%),
                radial-gradient(ellipse at 70% 60%, rgba(30,0,40,0.9) 0%, transparent 40%),
                radial-gradient(ellipse at center, rgba(0,0,0,0.95) 0%, rgba(40,0,20,0.98) 100%);
            backdrop-filter: blur(15px) saturate(0.8);
            z-index: 9999;
            display: none;
            animation: fadeIn 0.3s ease-out;
            overflow: hidden;
        }
        
        /* 克苏鲁触手背景动画 */
        .pause-overlay::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            background: 
                radial-gradient(circle at 20% 30%, transparent 30%, rgba(80,0,120,0.1) 31%, transparent 32%),
                radial-gradient(circle at 80% 70%, transparent 25%, rgba(120,0,80,0.1) 26%, transparent 27%),
                radial-gradient(circle at 50% 50%, transparent 40%, rgba(100,0,100,0.05) 41%, transparent 42%);
            animation: tentacleMove 20s ease-in-out infinite;
            filter: blur(2px);
        }
        
        @keyframes tentacleMove {
            0%, 100% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(45deg) scale(1.1); }
            50% { transform: rotate(-30deg) scale(0.95); }
            75% { transform: rotate(20deg) scale(1.05); }
        }
        
        .pause-overlay.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .pause-container {
            position: relative;
            width: 90%;
            max-width: 800px;
            background: 
                linear-gradient(135deg, rgba(20,0,30,0.95) 0%, rgba(40,0,50,0.95) 50%, rgba(30,0,40,0.95) 100%),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M10,50 Q30,20 50,50 T90,50" stroke="rgba(100,0,150,0.1)" fill="none" stroke-width="0.5"/></svg>');
            border: 3px solid transparent;
            border-image: linear-gradient(45deg, 
                rgba(150,0,200,0.8), 
                rgba(200,0,100,0.6), 
                rgba(100,0,150,0.8), 
                rgba(150,0,255,0.6)) 1;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 
                0 0 100px rgba(150,0,200,0.4),
                0 0 200px rgba(100,0,150,0.2),
                inset 0 0 100px rgba(80,0,120,0.3),
                inset 0 0 50px rgba(100,0,50,0.2);
            animation: pausePulse 3s ease-in-out infinite, eldritchGlow 5s ease-in-out infinite;
            overflow: hidden;
        }
        
        /* 古老符文装饰 */
        .pause-container::before {
            content: '☠ ⚛ ⟁ ⌘ ⟐ ☣ ⚛ ⟁';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 20px;
            color: rgba(150,0,200,0.2);
            letter-spacing: 20px;
            animation: runeFloat 10s linear infinite;
        }
        
        .pause-container::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: 
                repeating-linear-gradient(90deg, 
                    transparent, 
                    transparent 50px, 
                    rgba(100,0,150,0.03) 50px, 
                    rgba(100,0,150,0.03) 51px),
                repeating-linear-gradient(0deg, 
                    transparent, 
                    transparent 50px, 
                    rgba(150,0,100,0.03) 50px, 
                    rgba(150,0,100,0.03) 51px);
            pointer-events: none;
            animation: gridShift 20s linear infinite;
        }
        
        @keyframes runeFloat {
            0% { transform: translateX(-50%) rotate(0deg); }
            100% { transform: translateX(-50%) rotate(360deg); }
        }
        
        @keyframes gridShift {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }
        
        @keyframes eldritchGlow {
            0%, 100% { 
                filter: hue-rotate(0deg) brightness(1);
            }
            33% { 
                filter: hue-rotate(30deg) brightness(1.1);
            }
            66% { 
                filter: hue-rotate(-30deg) brightness(0.9);
            }
        }
        
        @keyframes pausePulse {
            0%, 100% { 
                box-shadow: 
                    0 0 100px rgba(255,0,100,0.3),
                    inset 0 0 50px rgba(100,0,50,0.2);
            }
            50% { 
                box-shadow: 
                    0 0 150px rgba(200,0,255,0.4),
                    inset 0 0 70px rgba(150,0,100,0.3);
            }
        }
        
        .pause-title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 42px;
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            color: #cc00ff;
            text-shadow: 
                0 0 30px rgba(200,0,255,0.9),
                0 0 60px rgba(150,0,200,0.6),
                0 0 90px rgba(100,0,150,0.4),
                2px 2px 4px rgba(0,0,0,0.8);
            letter-spacing: 8px;
            text-transform: uppercase;
            animation: eldritchText 4s ease-in-out infinite;
        }
        
        @keyframes eldritchText {
            0%, 100% { 
                transform: scale(1) rotateX(0deg);
                filter: blur(0px);
            }
            25% { 
                transform: scale(1.02) rotateX(2deg);
                filter: blur(0.5px);
            }
            50% { 
                transform: scale(0.98) rotateX(-2deg);
                filter: blur(0.3px);
            }
            75% { 
                transform: scale(1.01) rotateX(1deg);
                filter: blur(0.2px);
            }
        }
        
        .glitch-text {
            position: relative;
            animation: glitch 3s infinite;
            display: inline-block;
        }
        
        .glitch-text::before,
        .glitch-text::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .glitch-text::before {
            animation: glitch-1 0.7s infinite;
            color: #ff00aa;
            z-index: -1;
            text-shadow: -2px 0 rgba(150,0,255,0.5);
        }
        
        .glitch-text::after {
            animation: glitch-2 0.7s infinite reverse;
            color: #aa00ff;
            z-index: -2;
            text-shadow: 2px 0 rgba(255,0,150,0.5);
        }
        
        @keyframes glitch {
            0%, 100% { transform: translate(0); }
            20% { transform: translate(-1px, 1px); }
            40% { transform: translate(1px, -1px); }
            60% { transform: translate(-1px, 0); }
            80% { transform: translate(1px, 0); }
        }
        
        @keyframes glitch-1 {
            0%, 100% { clip-path: inset(0 0 100% 0); }
            25% { clip-path: inset(0 0 50% 0); }
            50% { clip-path: inset(50% 0 0 0); }
            75% { clip-path: inset(20% 0 30% 0); }
        }
        
        @keyframes glitch-2 {
            0%, 100% { clip-path: inset(100% 0 0 0); }
            25% { clip-path: inset(50% 0 0 0); }
            50% { clip-path: inset(0 0 50% 0); }
            75% { clip-path: inset(30% 0 20% 0); }
        }
        
        .pause-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            padding: 25px;
            background: 
                linear-gradient(90deg, 
                    rgba(0,0,0,0.7) 0%, 
                    rgba(40,0,60,0.5) 50%, 
                    rgba(0,0,0,0.7) 100%),
                repeating-linear-gradient(45deg,
                    transparent,
                    transparent 10px,
                    rgba(100,0,150,0.05) 10px,
                    rgba(100,0,150,0.05) 20px);
            border-radius: 15px;
            border: 2px solid transparent;
            border-image: linear-gradient(90deg, 
                rgba(150,0,200,0.5), 
                rgba(200,0,150,0.7), 
                rgba(150,0,200,0.5)) 1;
            position: relative;
            overflow: hidden;
        }
        
        .pause-stats::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at center, 
                transparent 30%, 
                rgba(150,0,255,0.1) 31%, 
                transparent 32%);
            animation: eyeWatch 8s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes eyeWatch {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(10%, -10%) scale(1.1); }
            50% { transform: translate(-10%, 10%) scale(0.9); }
            75% { transform: translate(5%, 5%) scale(1.05); }
        }
        
        .stat-item {
            text-align: center;
            position: relative;
        }
        
        /* 眼睛图标装饰 */
        .eye-icon {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 20px;
            animation: eyeBlink 5s infinite;
            filter: hue-rotate(280deg) saturate(2);
            opacity: 0.6;
        }
        
        @keyframes eyeBlink {
            0%, 90%, 100% { transform: translateX(-50%) scaleY(1); }
            95% { transform: translateX(-50%) scaleY(0.1); }
        }
        
        .stat-label {
            display: block;
            color: #ff88ff;
            font-size: 12px;
            margin-bottom: 5px;
            margin-top: 10px;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-value {
            display: block;
            color: #ff00ff;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255,0,255,0.5);
        }
        
        /* 副标题 - 克苏鲁风格 */
        .subtitle-eldritch {
            font-size: 14px;
            color: rgba(180,100,255,0.6);
            font-style: italic;
            margin-top: 10px;
            letter-spacing: 3px;
            animation: fadeInOut 4s ease-in-out infinite;
        }
        
        @keyframes fadeInOut {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 0.8; }
        }
        
        /* 符文边框装饰 */
        .rune-border-top,
        .rune-border-bottom {
            position: absolute;
            width: 100%;
            text-align: center;
            font-size: 18px;
            color: rgba(150,0,200,0.3);
            letter-spacing: 15px;
            pointer-events: none;
            animation: runeGlow 6s ease-in-out infinite;
        }
        
        .rune-border-top {
            top: -10px;
            left: 0;
        }
        
        .rune-border-bottom {
            bottom: -10px;
            left: 0;
            transform: rotate(180deg);
        }
        
        @keyframes runeGlow {
            0%, 100% { 
                color: rgba(150,0,200,0.3);
                text-shadow: none;
            }
            50% { 
                color: rgba(200,0,255,0.5);
                text-shadow: 0 0 20px rgba(200,0,255,0.8);
            }
        }
        
        /* 触手装饰层 */
        .tentacle-layer {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }
        
        .tentacle-layer::before,
        .tentacle-layer::after {
            content: '';
            position: absolute;
            width: 300px;
            height: 300px;
            border: 3px solid rgba(100,0,150,0.2);
            border-radius: 50% 40% 60% 30%;
            animation: tentacleWave 15s ease-in-out infinite;
        }
        
        .tentacle-layer::before {
            top: 10%;
            left: -150px;
            animation-delay: 0s;
        }
        
        .tentacle-layer::after {
            bottom: 10%;
            right: -150px;
            animation-delay: 7.5s;
            transform: rotate(180deg);
        }
        
        @keyframes tentacleWave {
            0%, 100% { 
                transform: translateX(0) rotate(0deg) scale(1);
                border-color: rgba(100,0,150,0.2);
            }
            25% { 
                transform: translateX(100px) rotate(90deg) scale(1.2);
                border-color: rgba(150,0,200,0.3);
            }
            50% { 
                transform: translateX(50px) rotate(180deg) scale(0.9);
                border-color: rgba(200,0,150,0.25);
            }
            75% { 
                transform: translateX(150px) rotate(270deg) scale(1.1);
                border-color: rgba(150,0,250,0.3);
            }
        }
        
        /* DNA螺旋背景 */
        .dna-helix-bg {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.15;
        }
        
        .dna-strand {
            position: absolute;
            width: 100%;
            height: 200px;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 20px,
                rgba(0,255,200,0.3) 20px,
                rgba(0,255,200,0.3) 22px,
                transparent 22px,
                transparent 40px,
                rgba(255,0,200,0.3) 40px,
                rgba(255,0,200,0.3) 42px
            );
            animation: dnaRotate 20s linear infinite;
        }
        
        .strand-1 {
            top: 20%;
            transform: perspective(500px) rotateX(60deg);
        }
        
        .strand-2 {
            bottom: 20%;
            transform: perspective(500px) rotateX(-60deg);
            animation-direction: reverse;
        }
        
        @keyframes dnaRotate {
            0% { background-position: 0 0; }
            100% { background-position: 100px 0; }
        }
        
        /* 浮动基因序列 */
        .floating-genes {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .gene-code {
            position: absolute;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: rgba(0,255,150,0.4);
            text-shadow: 0 0 10px rgba(0,255,150,0.6);
            animation: floatGene 15s infinite ease-in-out;
        }
        
        .gene-code:nth-child(1) {
            top: 15%; left: 10%;
            animation-delay: 0s;
        }
        
        .gene-code:nth-child(2) {
            top: 25%; right: 15%;
            animation-delay: 3s;
        }
        
        .gene-code:nth-child(3) {
            bottom: 30%; left: 20%;
            animation-delay: 6s;
        }
        
        .gene-code:nth-child(4) {
            bottom: 20%; right: 10%;
            animation-delay: 9s;
        }
        
        @keyframes floatGene {
            0%, 100% { 
                transform: translateY(0) scale(1);
                opacity: 0.4;
            }
            25% { 
                transform: translateY(-20px) scale(1.1);
                opacity: 0.7;
            }
            50% { 
                transform: translateY(10px) scale(0.9);
                opacity: 0.5;
            }
            75% { 
                transform: translateY(-10px) scale(1.05);
                opacity: 0.6;
            }
        }
        
        /* 克苏鲁之眼 */
        .cthulhu-eye {
            position: absolute;
            width: 80px;
            height: 80px;
            top: 10%;
            right: 10%;
            background: radial-gradient(
                circle at center,
                rgba(255,0,0,0.8) 0%,
                rgba(150,0,50,0.6) 20%,
                rgba(100,0,100,0.4) 40%,
                transparent 70%
            );
            border-radius: 50% 20% 50% 20%;
            animation: eyeStare 8s ease-in-out infinite;
            filter: blur(1px);
        }
        
        .cthulhu-eye::before {
            content: '';
            position: absolute;
            width: 30px;
            height: 30px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: radial-gradient(
                circle at center,
                #000 30%,
                rgba(255,0,100,0.8) 35%,
                transparent 70%
            );
            border-radius: 50%;
            animation: pupilMove 4s ease-in-out infinite;
        }
        
        .cthulhu-eye.eye-2 {
            top: auto;
            bottom: 15%;
            left: 8%;
            animation-delay: 4s;
            transform: rotate(180deg);
        }
        
        @keyframes eyeStare {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                filter: blur(1px) hue-rotate(0deg);
            }
            25% { 
                transform: scale(1.2) rotate(10deg);
                filter: blur(0.5px) hue-rotate(20deg);
            }
            50% { 
                transform: scale(0.8) rotate(-5deg);
                filter: blur(2px) hue-rotate(-20deg);
            }
            75% { 
                transform: scale(1.1) rotate(5deg);
                filter: blur(0.8px) hue-rotate(10deg);
            }
        }
        
        @keyframes pupilMove {
            0%, 100% { transform: translate(-50%, -50%); }
            25% { transform: translate(-40%, -40%); }
            50% { transform: translate(-60%, -50%); }
            75% { transform: translate(-45%, -60%); }
        }
        
        /* 生物膜效果 */
        .bio-membrane {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: 
                radial-gradient(ellipse at 20% 30%, rgba(150,0,200,0.05) 0%, transparent 40%),
                radial-gradient(ellipse at 80% 70%, rgba(200,0,150,0.05) 0%, transparent 40%),
                radial-gradient(ellipse at 50% 50%, rgba(100,0,150,0.03) 0%, transparent 60%);
            animation: membraneBreath 6s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes membraneBreath {
            0%, 100% { 
                transform: scale(1);
                opacity: 0.3;
            }
            50% { 
                transform: scale(1.05);
                opacity: 0.5;
            }
        }
        
        /* 变异警告 */
        .mutation-warning {
            font-size: 12px;
            color: rgba(255,100,0,0.8);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 8px;
            animation: warningPulse 2s ease-in-out infinite;
        }
        
        @keyframes warningPulse {
            0%, 100% { 
                opacity: 0.6;
                text-shadow: 0 0 5px rgba(255,100,0,0.5);
            }
            50% { 
                opacity: 1;
                text-shadow: 0 0 15px rgba(255,100,0,0.8);
            }
        }
        
        .pause-menu {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .pause-btn {
            padding: 24px 32px;
            background: 
                /* 肌肉纹理层 */
                repeating-linear-gradient(90deg,
                    rgba(80,10,30,0.9) 0px,
                    rgba(100,15,40,0.9) 2px,
                    rgba(80,10,30,0.9) 4px,
                    rgba(60,5,20,0.9) 6px,
                    rgba(80,10,30,0.9) 8px),
                /* 血管网络 */
                radial-gradient(ellipse at 25% 30%, 
                    rgba(180,0,60,0.4) 0%, 
                    transparent 30%),
                radial-gradient(ellipse at 75% 70%, 
                    rgba(150,0,80,0.4) 0%, 
                    transparent 30%),
                radial-gradient(ellipse at 50% 50%, 
                    rgba(120,0,50,0.3) 0%, 
                    transparent 40%),
                /* 皮下组织 */
                linear-gradient(135deg, 
                    rgba(60,10,30,0.95) 0%, 
                    rgba(80,15,40,0.95) 25%, 
                    rgba(100,20,50,0.95) 50%, 
                    rgba(80,15,40,0.95) 75%, 
                    rgba(60,10,30,0.95) 100%);
            border: 4px solid transparent;
            border-image: 
                repeating-linear-gradient(45deg,
                    rgba(200,20,80,0.9),
                    rgba(150,10,60,0.9) 2px,
                    rgba(200,20,80,0.9) 4px,
                    rgba(250,30,100,0.9) 6px) 1;
            color: #ffccdd;
            font-size: 14px;
            font-weight: bold;
            font-family: 'Georgia', serif;
            cursor: pointer;
            border-radius: 20px 15px 20px 15px / 15px 20px 15px 20px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 
                /* 外部阴影 - 血液渗出效果 */
                0 8px 25px rgba(150,0,50,0.5),
                0 15px 50px rgba(100,0,30,0.3),
                /* 内部阴影 - 凹陷的肉质感 */
                inset 0 2px 5px rgba(255,100,150,0.2),
                inset 0 -3px 8px rgba(50,0,20,0.8),
                inset 3px 3px 10px rgba(0,0,0,0.5),
                inset -3px -3px 10px rgba(100,0,50,0.3);
            /* 湿润的表面效果 */
            filter: contrast(1.1) saturate(1.2);
        }
        
        /* 血管脉动效果 */
        .pause-btn::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                repeating-conic-gradient(
                    from 0deg at 50% 50%,
                    transparent 0deg,
                    rgba(255,0,50,0.1) 5deg,
                    transparent 10deg,
                    rgba(200,0,80,0.1) 15deg,
                    transparent 20deg);
            animation: veinsPulse 8s linear infinite;
            opacity: 0.5;
        }
        
        @keyframes veinsPulse {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }
        
        /* 肉质表面纹理 */
        .pause-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(45deg,
                    transparent,
                    transparent 3px,
                    rgba(255,50,100,0.05) 3px,
                    rgba(255,50,100,0.05) 6px),
                repeating-linear-gradient(-45deg,
                    transparent,
                    transparent 3px,
                    rgba(200,30,80,0.05) 3px,
                    rgba(200,30,80,0.05) 6px);
            animation: fleshBreath 4s ease-in-out infinite;
        }
        
        @keyframes fleshBreath {
            0%, 100% { 
                opacity: 0.3;
                transform: scale(1);
            }
            50% { 
                opacity: 0.5;
                transform: scale(1.02);
            }
        }
        
        /* 有机图标容器 - 血肉化 */
        .organic-icon {
            position: relative;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            background: 
                /* 中心器官 */
                radial-gradient(circle at center, 
                    rgba(150,20,60,0.6) 0%, 
                    rgba(100,10,40,0.5) 30%, 
                    rgba(80,5,30,0.4) 50%, 
                    transparent 70%);
            border-radius: 50% 45% 55% 40% / 45% 50% 40% 55%;
            animation: organPulse 3s ease-in-out infinite;
            box-shadow: 
                inset 0 0 20px rgba(100,0,50,0.4),
                inset 0 0 10px rgba(0,0,0,0.5);
        }
        
        @keyframes organPulse {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                border-radius: 50% 45% 55% 40% / 45% 50% 40% 55%;
            }
            25% { 
                transform: scale(1.05) rotate(5deg);
                border-radius: 45% 50% 50% 45% / 50% 45% 45% 50%;
            }
            50% { 
                transform: scale(0.95) rotate(-3deg);
                border-radius: 55% 40% 45% 50% / 40% 55% 50% 45%;
            }
            75% { 
                transform: scale(1.02) rotate(2deg);
                border-radius: 40% 55% 50% 45% / 55% 40% 45% 50%;
            }
        }
        
        .icon-text {
            font-size: 28px;
            z-index: 3;
            position: relative;
            color: rgba(255,200,220,0.9);
            text-shadow: 
                0 0 10px rgba(255,100,150,0.8),
                0 0 20px rgba(200,50,100,0.5),
                0 2px 4px rgba(0,0,0,0.8);
            filter: drop-shadow(0 0 8px currentColor);
            animation: iconGlow 4s ease-in-out infinite;
        }
        
        @keyframes iconGlow {
            0%, 100% { 
                filter: drop-shadow(0 0 8px currentColor) brightness(1);
            }
            50% { 
                filter: drop-shadow(0 0 15px currentColor) brightness(1.2);
            }
        }
        
        /* 血滴效果 - Resume按钮 - 真实血液 */
        .blood-drop {
            position: absolute;
            width: 100%;
            height: 100%;
            background: 
                /* 多层血液 */
                radial-gradient(circle at 40% 40%, 
                    rgba(180,0,20,0.6) 0%, 
                    rgba(140,0,30,0.4) 20%, 
                    transparent 40%),
                radial-gradient(circle at 60% 60%, 
                    rgba(200,10,30,0.5) 0%, 
                    rgba(160,5,25,0.3) 25%, 
                    transparent 45%),
                radial-gradient(circle at center, 
                    rgba(255,0,50,0.4) 0%, 
                    rgba(180,0,40,0.3) 30%, 
                    rgba(120,0,30,0.2) 50%, 
                    transparent 70%);
            border-radius: 50% 50% 60% 60% / 60% 60% 40% 40%;
            animation: bloodFlow 4s ease-in-out infinite;
            filter: blur(0.5px);
            box-shadow: 
                inset 0 -5px 10px rgba(100,0,20,0.5),
                inset 0 2px 5px rgba(255,50,100,0.3);
        }
        
        .blood-drop::before {
            content: '';
            position: absolute;
            top: 30%;
            left: 30%;
            width: 20%;
            height: 20%;
            background: rgba(255,100,150,0.6);
            border-radius: 50%;
            filter: blur(2px);
            animation: bloodHighlight 3s ease-in-out infinite;
        }
        
        @keyframes bloodFlow {
            0%, 100% { 
                transform: scale(1) translateY(0) rotate(0deg);
                border-radius: 50% 50% 60% 60% / 60% 60% 40% 40%;
            }
            25% { 
                transform: scale(1.05) translateY(-3px) rotate(5deg);
                border-radius: 45% 55% 65% 55% / 55% 65% 35% 45%;
            }
            50% { 
                transform: scale(1.1) translateY(2px) rotate(-3deg);
                border-radius: 55% 45% 70% 70% / 70% 70% 30% 30%;
            }
            75% { 
                transform: scale(1.02) translateY(-1px) rotate(2deg);
                border-radius: 48% 52% 62% 58% / 58% 62% 38% 42%;
            }
        }
        
        @keyframes bloodHighlight {
            0%, 100% { 
                transform: translate(0, 0) scale(1);
                opacity: 0.6;
            }
            50% { 
                transform: translate(-5px, -5px) scale(0.8);
                opacity: 0.9;
            }
        }
        
        /* 神经网络效果 - Save按钮 - 大脑组织 */
        .neural-web {
            position: absolute;
            width: 100%;
            height: 100%;
            background: 
                /* 神经纤维 */
                repeating-linear-gradient(45deg,
                    transparent 0px,
                    transparent 2px,
                    rgba(200,100,150,0.2) 2px,
                    rgba(200,100,150,0.2) 3px,
                    transparent 3px,
                    transparent 6px),
                repeating-linear-gradient(-45deg,
                    transparent 0px,
                    transparent 2px,
                    rgba(150,80,200,0.2) 2px,
                    rgba(150,80,200,0.2) 3px,
                    transparent 3px,
                    transparent 6px),
                /* 脑组织纹理 */
                radial-gradient(ellipse at 30% 30%, 
                    rgba(180,80,120,0.3) 0%, 
                    transparent 30%),
                radial-gradient(ellipse at 70% 70%, 
                    rgba(160,90,140,0.3) 0%, 
                    transparent 30%),
                radial-gradient(circle at center, 
                    rgba(150,70,130,0.25) 0%, 
                    transparent 60%);
            animation: brainPulse 5s ease-in-out infinite;
            filter: contrast(1.2);
        }
        
        .neural-web::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: 
                repeating-conic-gradient(
                    from 0deg at center,
                    transparent 0deg,
                    rgba(255,150,200,0.1) 3deg,
                    transparent 6deg,
                    rgba(200,100,255,0.1) 9deg,
                    transparent 12deg);
            animation: synapsesFire 3s linear infinite;
        }
        
        @keyframes brainPulse {
            0%, 100% { 
                transform: scale(1);
                filter: contrast(1.2) brightness(1);
            }
            25% { 
                transform: scale(1.03);
                filter: contrast(1.3) brightness(1.1);
            }
            50% { 
                transform: scale(0.97);
                filter: contrast(1.1) brightness(0.95);
            }
            75% { 
                transform: scale(1.01);
                filter: contrast(1.25) brightness(1.05);
            }
        }
        
        @keyframes synapsesFire {
            0% { 
                transform: rotate(0deg);
                opacity: 0.3;
            }
            50% { 
                transform: rotate(180deg);
                opacity: 0.6;
            }
            100% { 
                transform: rotate(360deg);
                opacity: 0.3;
            }
        }
        
        /* 眼球血管效果 - Settings按钮 */
        .eye-veins {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, 
                transparent 20%, 
                rgba(255,0,100,0.1) 25%, 
                transparent 30%,
                rgba(200,0,50,0.1) 35%,
                transparent 40%);
            border-radius: 50%;
            animation: eyeTwitch 5s ease-in-out infinite;
        }
        
        .eye-veins::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-conic-gradient(
                from 0deg at center,
                transparent 0deg,
                rgba(255,0,50,0.1) 10deg,
                transparent 20deg
            );
            animation: veinsRotate 20s linear infinite;
        }
        
        @keyframes eyeTwitch {
            0%, 100% { transform: scale(1); }
            10% { transform: scale(1.05) rotate(5deg); }
            20% { transform: scale(0.95) rotate(-3deg); }
        }
        
        @keyframes veinsRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 骷髅触手效果 - Abort按钮 */
        .skull-tentacles {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, 
                rgba(255,0,0,0.4) 0%, 
                rgba(100,0,0,0.3) 30%, 
                transparent 60%);
            animation: skullPulse 2s ease-in-out infinite;
        }
        
        .skull-tentacles::before,
        .skull-tentacles::after {
            content: '';
            position: absolute;
            width: 60%;
            height: 3px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,0,0,0.5), 
                transparent);
            top: 50%;
            left: 50%;
            transform-origin: left center;
        }
        
        .skull-tentacles::before {
            transform: translate(-50%, -50%) rotate(45deg);
            animation: tentacleSwing 3s ease-in-out infinite;
        }
        
        .skull-tentacles::after {
            transform: translate(-50%, -50%) rotate(-45deg);
            animation: tentacleSwing 3s ease-in-out infinite reverse;
        }
        
        @keyframes skullPulse {
            0%, 100% { 
                transform: scale(1);
                filter: brightness(1);
            }
            50% { 
                transform: scale(1.1);
                filter: brightness(1.2);
            }
        }
        
        @keyframes tentacleSwing {
            0%, 100% { transform: translate(-50%, -50%) rotate(45deg) scaleX(1); }
            50% { transform: translate(-50%, -50%) rotate(60deg) scaleX(1.2); }
        }
        
        .btn-label {
            font-size: 16px;
            font-weight: bold;
            text-shadow: 0 0 10px currentColor;
        }
        
        .btn-sublabel {
            font-size: 10px;
            opacity: 0.7;
            font-style: italic;
            letter-spacing: 1px;
        }
        
        .pause-btn::before {
            content: '⟁';
            position: absolute;
            left: -30px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 30px;
            color: rgba(200,0,255,0.2);
            transition: all 0.4s ease;
        }
        
        .pause-btn::after {
            content: '⟁';
            position: absolute;
            right: -30px;
            top: 50%;
            transform: translateY(-50%) rotate(180deg);
            font-size: 30px;
            color: rgba(200,0,255,0.2);
            transition: all 0.4s ease;
        }
        
        .pause-btn:hover::before {
            left: 10px;
            color: rgba(255,0,200,0.4);
        }
        
        .pause-btn:hover::after {
            right: 10px;
            color: rgba(255,0,200,0.4);
        }
        
        .pause-btn:hover {
            background: 
                /* 撕裂的肌肉纹理 */
                repeating-linear-gradient(90deg,
                    rgba(120,20,50,0.95) 0px,
                    rgba(150,30,70,0.95) 1px,
                    rgba(120,20,50,0.95) 2px,
                    rgba(100,15,40,0.95) 3px,
                    rgba(120,20,50,0.95) 4px),
                /* 充血的血管 */
                radial-gradient(ellipse at 20% 30%, 
                    rgba(255,0,80,0.5) 0%, 
                    transparent 25%),
                radial-gradient(ellipse at 80% 70%, 
                    rgba(200,0,100,0.5) 0%, 
                    transparent 25%),
                radial-gradient(ellipse at 50% 50%, 
                    rgba(180,0,60,0.4) 0%, 
                    transparent 35%),
                /* 肿胀的皮下组织 */
                linear-gradient(135deg, 
                    rgba(100,20,50,0.98) 0%, 
                    rgba(130,30,70,0.98) 25%, 
                    rgba(160,40,90,0.98) 50%, 
                    rgba(130,30,70,0.98) 75%, 
                    rgba(100,20,50,0.98) 100%);
            border-image: 
                repeating-linear-gradient(45deg,
                    rgba(255,50,120,1),
                    rgba(200,30,90,1) 1px,
                    rgba(255,50,120,1) 2px,
                    rgba(255,80,150,1) 3px) 1;
            color: #ffe0e8;
            transform: translateY(-3px) scale(1.08) rotate(0.5deg);
            box-shadow: 
                /* 血液溢出效果 */
                0 12px 40px rgba(200,0,80,0.7),
                0 20px 60px rgba(150,0,60,0.5),
                0 30px 80px rgba(100,0,40,0.3),
                /* 肿胀的立体感 */
                inset 0 3px 8px rgba(255,150,200,0.3),
                inset 0 -5px 15px rgba(80,0,30,0.9),
                inset 5px 5px 15px rgba(0,0,0,0.6),
                inset -5px -5px 15px rgba(150,0,80,0.4);
            text-shadow: 
                0 0 20px rgba(255,150,200,0.9),
                0 2px 4px rgba(0,0,0,0.8);
            filter: contrast(1.3) saturate(1.5) brightness(1.1);
            animation: fleshTwitch 0.3s ease-in-out;
        }
        
        @keyframes fleshTwitch {
            0% { transform: translateY(-3px) scale(1.08) rotate(0.5deg); }
            25% { transform: translateY(-3px) scale(1.1) rotate(-0.5deg); }
            50% { transform: translateY(-3px) scale(1.07) rotate(0.3deg); }
            75% { transform: translateY(-3px) scale(1.09) rotate(-0.3deg); }
            100% { transform: translateY(-3px) scale(1.08) rotate(0.5deg); }
        }
        
        .pause-btn:hover .organic-icon {
            animation: iconMutate 0.5s ease-in-out;
        }
        
        @keyframes iconMutate {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.2) rotate(-5deg); }
            50% { transform: scale(0.9) rotate(5deg); }
            75% { transform: scale(1.1) rotate(-3deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        .pause-btn:hover .blood-drop {
            animation: bloodDrip 2s ease-in-out infinite;
        }
        
        @keyframes bloodDrip {
            0%, 100% { 
                transform: scale(1) translateY(0);
                border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            }
            50% { 
                transform: scale(1.2) translateY(5px);
                border-radius: 50% 50% 80% 80% / 40% 40% 60% 60%;
            }
        }
        
        .pause-btn:hover .neural-web {
            animation: neuralSpark 1s ease-in-out infinite;
        }
        
        @keyframes neuralSpark {
            0%, 100% { 
                filter: brightness(1) hue-rotate(0deg);
            }
            25% { 
                filter: brightness(1.5) hue-rotate(30deg);
            }
            50% { 
                filter: brightness(2) hue-rotate(-30deg);
            }
            75% { 
                filter: brightness(1.3) hue-rotate(15deg);
            }
        }
        
        .pause-btn:hover .eye-veins::before {
            animation: veinsRotate 2s linear infinite, veinsPulse 0.5s ease-in-out infinite;
        }
        
        @keyframes veinsPulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        .pause-btn:hover .skull-tentacles {
            animation: skullScream 1s ease-in-out infinite;
        }
        
        @keyframes skullScream {
            0%, 100% { 
                transform: scale(1);
                filter: brightness(1) contrast(1);
            }
            25% { 
                transform: scale(1.3);
                filter: brightness(1.5) contrast(1.2);
            }
            50% { 
                transform: scale(0.8);
                filter: brightness(0.8) contrast(1.5);
            }
            75% { 
                transform: scale(1.1);
                filter: brightness(1.2) contrast(1.1);
            }
        }
        
        .pause-btn.danger {
            background: 
                linear-gradient(135deg, 
                    rgba(80,0,0,0.9) 0%, 
                    rgba(120,10,0,0.9) 30%, 
                    rgba(140,0,0,0.9) 60%, 
                    rgba(80,0,0,0.9) 100%),
                radial-gradient(ellipse at 30% 30%, 
                    rgba(255,0,0,0.3) 0%, 
                    transparent 40%),
                radial-gradient(ellipse at 70% 70%, 
                    rgba(200,0,0,0.3) 0%, 
                    transparent 40%),
                repeating-linear-gradient(45deg,
                    transparent,
                    transparent 10px,
                    rgba(100,0,0,0.1) 10px,
                    rgba(100,0,0,0.1) 20px);
            border-image: linear-gradient(135deg, 
                rgba(255,0,0,0.9), 
                rgba(200,0,0,0.7), 
                rgba(255,0,0,0.9)) 1;
            color: #ff9999;
            animation: dangerPulse 3s ease-in-out infinite;
        }
        
        @keyframes dangerPulse {
            0%, 100% { 
                filter: brightness(1) saturate(1);
            }
            50% { 
                filter: brightness(1.1) saturate(1.3);
            }
        }
        
        .pause-btn.danger::before,
        .pause-btn.danger::after {
            content: '⚠';
            color: rgba(255,0,0,0.4);
            font-size: 40px;
            animation: warningFlash 2s ease-in-out infinite;
        }
        
        @keyframes warningFlash {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 0.8; }
        }
        
        .pause-btn.danger:hover {
            background: 
                linear-gradient(135deg, 
                    rgba(150,0,0,0.95) 0%, 
                    rgba(200,20,0,0.95) 30%, 
                    rgba(255,0,0,0.95) 60%, 
                    rgba(150,0,0,0.95) 100%),
                radial-gradient(ellipse at 30% 30%, 
                    rgba(255,50,0,0.5) 0%, 
                    transparent 40%),
                radial-gradient(ellipse at 70% 70%, 
                    rgba(255,0,50,0.5) 0%, 
                    transparent 40%),
                repeating-linear-gradient(45deg,
                    transparent,
                    transparent 5px,
                    rgba(255,0,0,0.2) 5px,
                    rgba(255,0,0,0.2) 10px);
            border-image: linear-gradient(135deg, 
                rgba(255,50,0,1), 
                rgba(255,0,50,0.9), 
                rgba(255,50,0,1)) 1;
            box-shadow: 
                0 10px 50px rgba(255,0,0,0.7),
                0 20px 100px rgba(200,0,0,0.5),
                inset 0 0 50px rgba(255,0,0,0.4),
                inset 0 -5px 20px rgba(0,0,0,0.8);
            text-shadow: 0 0 20px rgba(255,50,50,1);
            animation: dangerShake 0.3s ease-in-out infinite;
        }
        
        @keyframes dangerShake {
            0%, 100% { transform: translateY(-3px) scale(1.05) rotate(0deg); }
            25% { transform: translateY(-3px) scale(1.05) rotate(-1deg); }
            75% { transform: translateY(-3px) scale(1.05) rotate(1deg); }
        }
        
        .pause-btn.danger:hover::before,
        .pause-btn.danger:hover::after {
            color: rgba(255,0,0,0.9);
            animation: warningFlash 0.3s ease-in-out infinite, warningRotate 2s linear infinite;
        }
        
        @keyframes warningRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .pause-btn.danger:hover .skull-tentacles {
            background: radial-gradient(circle at center, 
                rgba(255,0,0,0.6) 0%, 
                rgba(150,0,0,0.4) 30%, 
                transparent 60%);
            animation: skullScream 0.5s ease-in-out infinite, bloodSpatter 2s ease-in-out infinite;
        }
        
        @keyframes bloodSpatter {
            0%, 100% { 
                box-shadow: 
                    0 0 0 transparent,
                    0 0 0 transparent;
            }
            50% { 
                box-shadow: 
                    -10px -10px 20px rgba(255,0,0,0.3),
                    10px 10px 20px rgba(200,0,0,0.3);
            }
        }
        
        .btn-icon {
            font-size: 20px;
        }
        
        .pause-info {
            margin-bottom: 30px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            border: 1px solid rgba(255,0,100,0.2);
        }
        
        .info-item {
            text-align: center;
        }
        
        .info-label {
            color: #ff88ff;
            font-size: 11px;
            margin-bottom: 5px;
            opacity: 0.7;
            text-transform: uppercase;
        }
        
        .info-value {
            color: #ff00ff;
            font-size: 16px;
            font-weight: bold;
        }
        
        .info-value.status-ok {
            color: #00ff00;
        }
        
        .pause-visual {
            position: relative;
            height: 120px;
            background: 
                linear-gradient(90deg, 
                    rgba(0,0,0,0.7) 0%, 
                    rgba(20,0,30,0.5) 50%, 
                    rgba(0,0,0,0.7) 100%);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid rgba(150,0,200,0.3);
        }
        
        /* DNA序列显示 */
        .dna-sequence-display {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 10px;
            padding: 10px;
        }
        
        .sequence-row {
            display: flex;
            gap: 15px;
            animation: sequenceScroll 20s linear infinite;
        }
        
        @keyframes sequenceScroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-200px); }
        }
        
        .base {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: bold;
            padding: 5px 8px;
            border-radius: 5px;
            background: rgba(0,0,0,0.5);
            border: 1px solid;
            text-shadow: 0 0 5px currentColor;
            animation: basePulse 3s ease-in-out infinite;
        }
        
        .base-a {
            color: #00ff88;
            border-color: rgba(0,255,136,0.5);
        }
        
        .base-t {
            color: #ff0088;
            border-color: rgba(255,0,136,0.5);
        }
        
        .base-c {
            color: #0088ff;
            border-color: rgba(0,136,255,0.5);
        }
        
        .base-g {
            color: #ffaa00;
            border-color: rgba(255,170,0,0.5);
        }
        
        .base-mutated {
            color: #ff00ff;
            border-color: rgba(255,0,255,0.8);
            background: rgba(150,0,150,0.3);
            animation: mutationGlow 1s ease-in-out infinite;
        }
        
        @keyframes basePulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        @keyframes mutationGlow {
            0%, 100% { 
                box-shadow: 0 0 10px rgba(255,0,255,0.5);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 20px rgba(255,0,255,0.8);
                transform: scale(1.1);
            }
        }
        
        .helix-connector {
            width: 80%;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(150,0,200,0.5) 20%, 
                rgba(200,0,150,0.5) 50%, 
                rgba(150,0,200,0.5) 80%, 
                transparent);
            animation: helixPulse 2s ease-in-out infinite;
        }
        
        @keyframes helixPulse {
            0%, 100% { transform: scaleX(1); opacity: 0.5; }
            50% { transform: scaleX(1.1); opacity: 0.8; }
        }
        
        /* 触手包裹效果 */
        .tentacle-wrap-left,
        .tentacle-wrap-right {
            position: absolute;
            width: 60px;
            height: 100%;
            top: 0;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(100,0,150,0.1) 10px,
                rgba(100,0,150,0.1) 15px
            );
            animation: tentacleWrap 10s ease-in-out infinite;
        }
        
        .tentacle-wrap-left {
            left: 0;
            border-right: 2px solid rgba(150,0,200,0.3);
            transform-origin: left center;
        }
        
        .tentacle-wrap-right {
            right: 0;
            border-left: 2px solid rgba(150,0,200,0.3);
            transform-origin: right center;
            animation-direction: reverse;
        }
        
        @keyframes tentacleWrap {
            0%, 100% { 
                transform: scaleX(1) skewY(0deg);
                opacity: 0.3;
            }
            25% { 
                transform: scaleX(1.2) skewY(5deg);
                opacity: 0.5;
            }
            50% { 
                transform: scaleX(0.9) skewY(-3deg);
                opacity: 0.4;
            }
            75% { 
                transform: scaleX(1.1) skewY(2deg);
                opacity: 0.45;
            }
        }
        
        #pauseWave {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .dna-preview {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            border: 3px solid rgba(255,0,255,0.5);
            border-radius: 50%;
            animation: rotateDNA 4s linear infinite;
        }
        
        .dna-preview::before,
        .dna-preview::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border: 2px solid rgba(255,0,100,0.5);
            border-radius: 50%;
            animation: pulseDNA 2s ease-in-out infinite;
        }
        
        .dna-preview::after {
            animation-delay: 1s;
        }
        
        @keyframes rotateDNA {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        @keyframes pulseDNA {
            0%, 100% { 
                transform: scale(1);
                opacity: 1;
            }
            50% { 
                transform: scale(1.5);
                opacity: 0;
            }
        }
        
        .membrane {
            position: fixed;
            width: 200px;
            height: 150px;
            background: radial-gradient(ellipse,
                rgba(150,100,80,0.2) 0%,
                rgba(120,80,60,0.3) 40%,
                rgba(100,60,40,0.4) 70%,
                transparent 100%);
            filter: blur(3px);
            animation: membraneStretch 10s ease-in-out infinite;
            z-index: 2;
            mix-blend-mode: multiply;
        }
        
        @keyframes membraneStretch {
            0%, 100% { transform: scale(1, 1) rotate(0deg); }
            33% { transform: scale(1.2, 0.9) rotate(5deg); }
            66% { transform: scale(0.9, 1.1) rotate(-5deg); }
        }
    </style>
</head>
<body>
    <!-- 自定义光标 -->
    <div class="cursor" id="cursor"></div>
    
    <!-- 血管网络 -->
    <div class="vein-network">
        <div class="vein" style="top: 10%; left: 0; width: 30%; transform: rotate(15deg);"></div>
        <div class="vein" style="top: 30%; left: 20%; width: 40%; transform: rotate(-20deg);"></div>
        <div class="vein" style="top: 50%; left: 40%; width: 35%; transform: rotate(25deg);"></div>
        <div class="vein" style="top: 70%; left: 10%; width: 50%; transform: rotate(-10deg);"></div>
        <div class="vein" style="top: 20%; right: 0; width: 45%; transform: rotate(160deg);"></div>
        <div class="vein" style="top: 60%; right: 20%; width: 30%; transform: rotate(-150deg);"></div>
    </div>
    
    <!-- 有机粘液 -->
    <div class="slime-drip" style="left: 15%; animation-delay: 0s;"></div>
    <div class="slime-drip" style="left: 45%; animation-delay: 2s;"></div>
    <div class="slime-drip" style="left: 75%; animation-delay: 4s;"></div>
    <div class="slime-drip" style="left: 85%; animation-delay: 6s;"></div>
    
    <!-- 腐败覆盖层 -->
    <div class="decay-overlay"></div>
    
    <!-- 触手 -->
    <div class="tentacle" style="bottom: -50px; left: 10%; animation-delay: 0s;"></div>
    <div class="tentacle" style="bottom: -50px; left: 30%; animation-delay: 1s; height: 250px;"></div>
    <div class="tentacle" style="bottom: -50px; right: 20%; animation-delay: 2s; height: 280px;"></div>
    <div class="tentacle" style="bottom: -50px; right: 10%; animation-delay: 3s;"></div>
    
    <!-- 眼球监视器 -->
    <div class="bio-eye" style="top: 15%; right: 15%;">
        <div class="eye-pupil"></div>
    </div>
    <div class="bio-eye" style="top: 70%; left: 10%; animation-delay: -2s;">
        <div class="eye-pupil"></div>
    </div>
    <div class="bio-eye" style="top: 40%; right: 8%; width: 60px; height: 60px; animation-delay: -4s;">
        <div class="eye-pupil" style="width: 20px; height: 20px; top: 20px; left: 20px;"></div>
    </div>
    
    <!-- 肿瘤/脓包 -->
    <div class="tumor" style="top: 25%; left: 5%;"></div>
    <div class="tumor" style="bottom: 30%; right: 10%; width: 90px; height: 80px; animation-delay: -2.5s;"></div>
    <div class="tumor" style="top: 60%; left: 15%; width: 100px; height: 90px; animation-delay: -5s;"></div>
    
    <!-- 血丝纹理 -->
    <div class="blood-vessel" style="top: 10%; left: 25%; transform: rotate(45deg);"></div>
    <div class="blood-vessel" style="top: 30%; left: 60%; transform: rotate(-30deg); height: 150px;"></div>
    <div class="blood-vessel" style="top: 50%; right: 30%; transform: rotate(60deg);"></div>
    <div class="blood-vessel" style="bottom: 20%; left: 40%; transform: rotate(-45deg); height: 120px;"></div>
    <div class="blood-vessel" style="top: 20%; right: 25%; transform: rotate(15deg); animation-delay: -1s;"></div>
    
    <!-- 筋膜组织 -->
    <div class="membrane" style="top: 35%; left: 20%;"></div>
    <div class="membrane" style="bottom: 25%; right: 15%; animation-delay: -3.3s;"></div>
    <div class="membrane" style="top: 55%; right: 35%; width: 150px; height: 120px; animation-delay: -6.6s;"></div>

    <!-- 加载屏幕 -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-text">INITIALIZING GENE THIEF...</div>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

    <!-- 主画布 -->
    <canvas id="canvas"></canvas>

    <!-- 黑洞容器 -->
    <div class="blackhole-container">
        <div class="accretion-disk"></div>
        <div class="event-horizon"></div>
        <div class="blackhole"></div>
    </div>

    <!-- 雾化层 -->
    <div class="fog-layer">
        <div class="fog" style="top: 20%; left: 10%;"></div>
        <div class="fog" style="top: 60%; left: 70%; animation-delay: -5s;"></div>
        <div class="fog" style="top: 40%; left: 40%; animation-delay: -10s;"></div>
    </div>

    <!-- 网格覆盖 -->
    <div class="grid-overlay"></div>

    <!-- 扫描线 -->
    <div class="scanline"></div>

    <!-- 非法基因采集控制面板 -->
    <div class="control-panel" id="controlPanel">
        <div class="panel-header">ILLEGAL GENE THIEF v3.7</div>
        
        <!-- 阶段指示器 -->
        <div class="phase-indicator">
            <div class="phase active" id="phase-extract" data-phase="extracting">EXTRACTING</div>
            <div class="phase" id="phase-react" data-phase="reacting">REACTING</div>
            <div class="phase" id="phase-transfer" data-phase="transferring">TRANSFERRING</div>
        </div>

        <!-- 样本信息模块 -->
        <div class="sample-info-module">
            <div class="module-title">🧬 SAMPLE INFORMATION</div>
            
            <div class="sample-item">
                <div class="sample-label">样本编号</div>
                <div class="sample-value glitch-text" data-text="SRC-0823-XF">
                    <span id="sample-id">SRC-0823-XF</span>
                </div>
            </div>
            
            <div class="sample-item">
                <div class="sample-label">采集部位</div>
                <div class="collection-site">
                    <div class="site-icon active" data-type="blood" title="血液">🩸</div>
                    <div class="site-icon" data-type="saliva" title="唾液">💧</div>
                    <div class="site-icon" data-type="neural" title="神经组织">🧠</div>
                    <div class="site-icon" data-type="tear" title="泪液">👁️</div>
                    <span class="site-text">血液样本</span>
                </div>
            </div>
            
            <div class="sample-item">
                <div class="sample-label">样本状态</div>
                <div class="sample-status">
                    <div class="status-light active" id="status-indicator"></div>
                    <span id="status-text">活性</span>
                </div>
            </div>
            
            <div class="sample-item">
                <div class="sample-label">采集进度</div>
                <div class="collection-progress">
                    <div class="progress-bar-vertical">
                        <div class="progress-fill" id="collection-fill"></div>
                        <div class="particle-stream"></div>
                    </div>
                    <span class="progress-text" id="collection-percent">73%</span>
                </div>
            </div>
        </div>

        <!-- 基因提取核心参数模块 -->
        <div class="gene-extract-module">
            <div class="module-title">⚗️ EXTRACTION PARAMETERS</div>
            
            <div class="param-item">
                <div class="param-label">纯度等级</div>
                <div class="purity-display">
                    <div class="circular-progress">
                        <svg width="60" height="60">
                            <circle cx="30" cy="30" r="25" fill="none" stroke="rgba(0,50,100,0.3)" stroke-width="3"></circle>
                            <circle cx="30" cy="30" r="25" fill="none" stroke="#00ffff" stroke-width="3" 
                                    stroke-dasharray="157" stroke-dashoffset="30" id="purity-ring"></circle>
                        </svg>
                        <span class="progress-value" id="purity-value">94.2%</span>
                    </div>
                </div>
            </div>
            
            <div class="param-item">
                <div class="param-label">活性评分</div>
                <div class="activity-score">
                    <span class="score-value heartbeat" id="activity-score">9.4</span>
                    <span class="score-max">/10</span>
                    <div class="pulse-indicator"></div>
                </div>
            </div>
            
            <div class="param-item">
                <div class="param-label">核苷酸链长度</div>
                <div class="chain-length">
                    <span id="chain-value">3.2M</span>
                    <span class="unit">bp</span>
                </div>
            </div>
            
            <div class="param-item">
                <div class="param-label">DNA/RNA 分离状态</div>
                <div class="separation-status">
                    <div class="separation-bar">
                        <div class="separation-dna" style="width: 68%;">DNA</div>
                        <div class="separation-rna" style="width: 32%;">RNA</div>
                    </div>
                    <div class="separation-text">68% : 32%</div>
                </div>
            </div>
        </div>

        <!-- 黑市价值指标模块 -->
        <div class="blackmarket-module">
            <div class="module-title">💰 BLACK MARKET VALUE</div>
            
            <div class="value-item">
                <div class="value-label">估价</div>
                <div class="market-price">
                    <span class="price-symbol">$</span>
                    <span class="price-value neon-glitch" id="market-price">48,300</span>
                </div>
            </div>
            
            <div class="value-item">
                <div class="value-label">需求热度</div>
                <div class="demand-heatmap">
                    <div class="heatmap-bar">
                        <div class="heat-segment low"></div>
                        <div class="heat-segment medium"></div>
                        <div class="heat-segment high active"></div>
                        <div class="heat-segment critical"></div>
                    </div>
                    <span class="demand-text">HIGH</span>
                </div>
            </div>
            
            <div class="value-item">
                <div class="value-label">交易风险级别</div>
                <div class="risk-level">
                    <div class="risk-indicator medium" id="risk-indicator">
                        <div class="warning-icon">⚠</div>
                        <span class="risk-text">MEDIUM</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 控制按钮 -->
        <div class="control-buttons">
            <button class="control-btn" id="btn-start">EXTRACT</button>
            <button class="control-btn" id="btn-pause">SUSPEND</button>
            <button class="control-btn" id="btn-reset">PURGE</button>
        </div>

        <!-- 高级控制 -->
        <div class="slider-control">
            <div class="slider-label">
                <span>Gene Complexity</span>
                <span id="complexity-value">75%</span>
            </div>
            <input type="range" class="slider" id="complexity-slider" min="0" max="100" value="75">
        </div>

        <div class="slider-control">
            <div class="slider-label">
                <span>Mutation Rate</span>
                <span id="mutation-value">30%</span>
            </div>
            <input type="range" class="slider" id="mutation-slider" min="0" max="100" value="30">
        </div>
    </div>

    <!-- 全屏按钮 -->
    <button class="fullscreen-btn" id="fullscreenBtn">⛶</button>

    <!-- 状态指示器 -->
    <div class="status-indicators">
        <div class="status-item" data-status="system">
            <div class="status-light active"></div>
            <div class="status-text">System Online</div>
        </div>
        <div class="status-item" data-status="containment">
            <div class="status-light active"></div>
            <div class="status-text">Containment Stable</div>
        </div>
        <div class="status-item" data-status="biohazard">
            <div class="status-light warning"></div>
            <div class="status-text">Bio-hazard Level 2</div>
        </div>
        <div class="status-item" data-status="genetic">
            <div class="status-light active"></div>
            <div class="status-text">Gene Analysis Active</div>
        </div>
    </div>



    <!-- 交互提示 -->
    <div class="interaction-hint" id="interactionHint">
        Press F11 for fullscreen | Press SPACE for effects
    </div>

    <!-- 音频可视化 -->
    <div class="audio-visualizer" id="audioVisualizer"></div>
    
    <!-- 生物危险警告 -->
    <div class="biohazard-warning" id="biohazardWarning">
        <div class="warning-title">⚠ BIOHAZARD DETECTED ⚠</div>
        <div class="warning-message">
            Genetic anomaly detected in extraction chamber.<br>
            Contamination level critical.<br>
            Immediate containment protocol initiated.
        </div>
    </div>
    
    <!-- 提取进度 -->
    <div class="extraction-progress" id="extractionProgress">
        <div class="progress-label">DNA EXTRACTION PROGRESS</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </div>
    
    <!-- 结果面板 -->
    <div class="result-panel" id="resultPanel">
        <div class="result-close" onclick="closeResults()">✕</div>
        <div class="result-title">EXTRACTION COMPLETE</div>
        <div class="result-data" id="resultData"></div>
    </div>
    
    <!-- 音频反馈 -->
    <div class="audio-feedback" id="audioFeedback"></div>
    
    <!-- 暂停界面 - 克苏鲁增强版 -->
    <div class="pause-overlay" id="pauseOverlay">
        <!-- 触手装饰层 -->
        <div class="tentacle-layer"></div>
        
        <!-- DNA螺旋背景 -->
        <div class="dna-helix-bg">
            <div class="dna-strand strand-1"></div>
            <div class="dna-strand strand-2"></div>
        </div>
        
        <!-- 浮动的基因序列 -->
        <div class="floating-genes">
            <span class="gene-code">ATCG</span>
            <span class="gene-code">GCTA</span>
            <span class="gene-code">TAGC</span>
            <span class="gene-code">CGAT</span>
        </div>
        
        <!-- 克苏鲁之眼 -->
        <div class="cthulhu-eye"></div>
        <div class="cthulhu-eye eye-2"></div>
        
        <div class="pause-container">
            <!-- 古老符文边框 -->
            <div class="rune-border-top">⟁ ☠ ⚛ ⌘ ⟐ ☣ ⚛ ⟁</div>
            <div class="rune-border-bottom">⟁ ⚛ ☣ ⟐ ⌘ ⚛ ☠ ⟁</div>
            
            <!-- 生物膜效果 -->
            <div class="bio-membrane"></div>
            
            <div class="pause-title">
                <span class="glitch-text" data-text="SYSTEM PAUSED">SYSTEM PAUSED</span>
                <div class="subtitle-eldritch">The Ancient Extraction Halts...</div>
                <div class="mutation-warning">⚠ GENETIC ANOMALY DETECTED ⚠</div>
            </div>
            
            <div class="pause-stats">
                <div class="stat-item">
                    <div class="eye-icon">👁</div>
                    <span class="stat-label">EXTRACTION TIME</span>
                    <span class="stat-value" id="pauseTime">00:00</span>
                </div>
                <div class="stat-item">
                    <div class="eye-icon">👁</div>
                    <span class="stat-label">GENES COLLECTED</span>
                    <span class="stat-value" id="pauseGenes">0</span>
                </div>
                <div class="stat-item">
                    <div class="eye-icon">👁</div>
                    <span class="stat-label">MUTATIONS FOUND</span>
                    <span class="stat-value" id="pauseMutations">0</span>
                </div>
            </div>
            
            <div class="pause-menu">
                <button class="pause-btn" id="resumeBtn">
                    <span class="btn-icon organic-icon">
                        <span class="blood-drop"></span>
                        <span class="icon-text">►</span>
                    </span>
                    <span class="btn-label">RESUME</span>
                    <span class="btn-sublabel">Continue Extraction</span>
                </button>
                <button class="pause-btn" id="saveBtn">
                    <span class="btn-icon organic-icon">
                        <span class="neural-web"></span>
                        <span class="icon-text">⬇</span>
                    </span>
                    <span class="btn-label">SAVE PROGRESS</span>
                    <span class="btn-sublabel">Store Genetic Data</span>
                </button>
                <button class="pause-btn" id="settingsBtn">
                    <span class="btn-icon organic-icon">
                        <span class="eye-veins"></span>
                        <span class="icon-text">☉</span>
                    </span>
                    <span class="btn-label">SETTINGS</span>
                    <span class="btn-sublabel">Modify Parameters</span>
                </button>
                <button class="pause-btn danger" id="abortBtn">
                    <span class="btn-icon organic-icon">
                        <span class="skull-tentacles"></span>
                        <span class="icon-text">☠</span>
                    </span>
                    <span class="btn-label">ABORT MISSION</span>
                    <span class="btn-sublabel">Terminate Sequence</span>
                </button>
            </div>
            
            <div class="pause-info">
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">Current Phase</div>
                        <div class="info-value" id="pausePhase">EXTRACTING</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">System Status</div>
                        <div class="info-value status-ok">STABLE</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Contamination</div>
                        <div class="info-value" id="pauseContamination">0%</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Energy Field</div>
                        <div class="info-value" id="pauseField">ACTIVE</div>
                    </div>
                </div>
            </div>
            
            <!-- DNA序列可视化 -->
            <div class="pause-visual">
                <div class="dna-preview"></div>
                <canvas id="pauseWave"></canvas>
                
                <!-- 基因序列显示 -->
                <div class="dna-sequence-display">
                    <div class="sequence-row">
                        <span class="base base-a">A</span>
                        <span class="base base-t">T</span>
                        <span class="base base-c">C</span>
                        <span class="base base-g">G</span>
                        <span class="base base-a">A</span>
                        <span class="base base-t">T</span>
                        <span class="base base-g">G</span>
                        <span class="base base-c">C</span>
                        <span class="base base-mutated">X</span>
                        <span class="base base-a">A</span>
                        <span class="base base-t">T</span>
                        <span class="base base-c">C</span>
                    </div>
                    <div class="helix-connector"></div>
                    <div class="sequence-row bottom">
                        <span class="base base-t">T</span>
                        <span class="base base-a">A</span>
                        <span class="base base-g">G</span>
                        <span class="base base-c">C</span>
                        <span class="base base-t">T</span>
                        <span class="base base-a">A</span>
                        <span class="base base-c">C</span>
                        <span class="base base-g">G</span>
                        <span class="base base-mutated">?</span>
                        <span class="base base-t">T</span>
                        <span class="base base-a">A</span>
                        <span class="base base-g">G</span>
                    </div>
                </div>
                
                <!-- 触手包裹效果 -->
                <div class="tentacle-wrap-left"></div>
                <div class="tentacle-wrap-right"></div>
            </div>
        </div>
    </div>
    
    <!-- 污染指示器 -->
    <div class="contamination-indicator">
        <div class="contamination-level">CONTAMINATION LEVEL</div>
        <div class="contamination-bar">
            <div class="contamination-marker" id="contaminationMarker"></div>
        </div>
    </div>

    <script>
        // 初始化变量
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let width = canvas.width = window.innerWidth;
        let height = canvas.height = window.innerHeight;

        // 鼠标追踪
        const cursor = document.getElementById('cursor');
        const mouse = { x: width / 2, y: height / 2, isPressed: false };
        
        // 自定义光标
        document.addEventListener('mousemove', (e) => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
            cursor.style.left = e.clientX - 10 + 'px';
            cursor.style.top = e.clientY - 10 + 'px';
            
            // 创建光标轨迹
            if (Math.random() > 0.9) {
                createCursorTrail(e.clientX, e.clientY);
            }
        });

        document.addEventListener('mousedown', () => {
            mouse.isPressed = true;
            cursor.classList.add('clicking');
        });

        document.addEventListener('mouseup', () => {
            mouse.isPressed = false;
            cursor.classList.remove('clicking');
        });

        // 创建光标轨迹
        function createCursorTrail(x, y) {
            const trail = document.createElement('div');
            trail.className = 'cursor-trail';
            trail.style.left = x - 5 + 'px';
            trail.style.top = y - 5 + 'px';
            document.body.appendChild(trail);
            
            setTimeout(() => trail.remove(), 1000);
        }

        // 应用状态
        const appState = {
            phase: 'extracting',
            isRunning: true,
            time: 0,
            phaseTime: 0,
            phaseDuration: 5000,
            blackholeActive: true,
            blackholeIntensity: 0.5,
            particleDensity: 0.75,
            geneComplexity: 0.75,
            mutationRate: 0.3,
            selectedDNA: [],
            extractionProgress: 0,
            contaminationLevel: 10,
            audioEnabled: false,
            extractionComplete: false,
            warningActive: false
        };
        
        // 音频系统
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        function playTone(frequency, duration, type = 'sine') {
            if (!appState.audioEnabled) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = frequency;
            oscillator.type = type;
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }
        
        function playWarningSound() {
            playTone(440, 0.1, 'square');
            setTimeout(() => playTone(330, 0.1, 'square'), 100);
        }
        
        function playSuccessSound() {
            playTone(523, 0.1);
            setTimeout(() => playTone(659, 0.1), 100);
            setTimeout(() => playTone(784, 0.2), 200);
        }
        
        function playClickSound() {
            playTone(600, 0.05, 'sine');
        }
        
        // 震动反馈
        function vibrate(pattern = [50]) {
            if ('vibrate' in navigator) {
                navigator.vibrate(pattern);
            }
        }
        
        // 用户通知系统
        function showNotification(message, type = 'info') {
            const feedback = document.getElementById('audioFeedback');
            feedback.textContent = message;
            feedback.style.display = 'block';
            feedback.style.background = type === 'error' ? 'rgba(100,0,0,0.8)' : 
                                       type === 'success' ? 'rgba(0,100,0,0.8)' : 
                                       'rgba(0,50,100,0.8)';
            feedback.style.borderColor = type === 'error' ? '#f00' : 
                                         type === 'success' ? '#0f0' : '#0ff';
            
            setTimeout(() => {
                feedback.style.display = 'none';
            }, 3000);
        }
        
        // 暂停界面功能
        let pauseStartTime = 0;
        let totalPauseTime = 0;
        let pauseWaveCtx = null;
        let pauseAnimationId = null;
        
        function showPauseOverlay() {
            const overlay = document.getElementById('pauseOverlay');
            overlay.classList.add('active');
            pauseStartTime = Date.now();
            
            // 更新暂停界面统计
            updatePauseStats();
            
            // 初始化暂停波形动画
            initPauseWave();
            
            // 播放暂停音效
            if (appState.audioEnabled) {
                playTone(200, 0.1, 200);
            }
            
            showNotification('System paused', 'info');
        }
        
        function hidePauseOverlay() {
            const overlay = document.getElementById('pauseOverlay');
            overlay.classList.remove('active');
            
            // 计算暂停时长
            if (pauseStartTime > 0) {
                totalPauseTime += Date.now() - pauseStartTime;
                pauseStartTime = 0;
            }
            
            // 停止暂停动画
            if (pauseAnimationId) {
                cancelAnimationFrame(pauseAnimationId);
                pauseAnimationId = null;
            }
            
            appState.isRunning = true;
            showNotification('System resumed', 'success');
        }
        
        function updatePauseStats() {
            // 更新时间
            const time = Math.floor(appState.time / 1000);
            const minutes = Math.floor(time / 60);
            const seconds = time % 60;
            document.getElementById('pauseTime').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // 更新收集的基因数
            document.getElementById('pauseGenes').textContent = appState.selectedDNA.length;
            
            // 更新发现的突变数
            const mutations = Math.floor(appState.selectedDNA.length * appState.mutationRate);
            document.getElementById('pauseMutations').textContent = mutations;
            
            // 更新当前阶段
            document.getElementById('pausePhase').textContent = appState.phase.toUpperCase();
            
            // 更新污染度
            document.getElementById('pauseContamination').textContent = 
                Math.floor(appState.contaminationLevel) + '%';
            
            // 更新能量场状态
            document.getElementById('pauseField').textContent = 
                appState.blackholeActive ? 'ACTIVE' : 'INACTIVE';
        }
        
        function initPauseWave() {
            const canvas = document.getElementById('pauseWave');
            if (!canvas) return;
            
            pauseWaveCtx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            let waveOffset = 0;
            
            function drawPauseWave() {
                if (!pauseWaveCtx) return;
                
                const width = canvas.width;
                const height = canvas.height;
                
                // 清除画布
                pauseWaveCtx.fillStyle = 'rgba(0,0,0,0.1)';
                pauseWaveCtx.fillRect(0, 0, width, height);
                
                // 绘制波形
                pauseWaveCtx.strokeStyle = 'rgba(255,0,255,0.5)';
                pauseWaveCtx.lineWidth = 2;
                pauseWaveCtx.beginPath();
                
                for (let x = 0; x < width; x += 5) {
                    const y = height / 2 + Math.sin((x + waveOffset) * 0.02) * 20 * 
                             Math.sin(waveOffset * 0.01);
                    
                    if (x === 0) {
                        pauseWaveCtx.moveTo(x, y);
                    } else {
                        pauseWaveCtx.lineTo(x, y);
                    }
                }
                
                pauseWaveCtx.stroke();
                
                // 第二条波形
                pauseWaveCtx.strokeStyle = 'rgba(255,100,200,0.3)';
                pauseWaveCtx.beginPath();
                
                for (let x = 0; x < width; x += 5) {
                    const y = height / 2 + Math.cos((x + waveOffset * 0.7) * 0.03) * 15;
                    
                    if (x === 0) {
                        pauseWaveCtx.moveTo(x, y);
                    } else {
                        pauseWaveCtx.lineTo(x, y);
                    }
                }
                
                pauseWaveCtx.stroke();
                
                waveOffset += 2;
                pauseAnimationId = requestAnimationFrame(drawPauseWave);
            }
            
            drawPauseWave();
        }
        
        // 生物危险警告
        function triggerBiohazardWarning() {
            const warning = document.getElementById('biohazardWarning');
            warning.style.display = 'block';
            appState.warningActive = true;
            playWarningSound();
            vibrate([100, 50, 100, 50, 200]);
            
            setTimeout(() => {
                warning.style.display = 'none';
                appState.warningActive = false;
            }, 3000);
        }
        
        // 更新污染等级
        function updateContaminationLevel(delta) {
            appState.contaminationLevel = Math.max(0, Math.min(100, appState.contaminationLevel + delta));
            const marker = document.getElementById('contaminationMarker');
            marker.style.left = appState.contaminationLevel + '%';
            
            if (appState.contaminationLevel > 60) {
                marker.style.background = '#f00';
                marker.style.boxShadow = '0 0 20px #f00';
                
                if (appState.contaminationLevel > 80 && Math.random() > 0.95) {
                    triggerBiohazardWarning();
                }
            } else if (appState.contaminationLevel > 30) {
                marker.style.background = '#ff0';
                marker.style.boxShadow = '0 0 15px #ff0';
            } else {
                marker.style.background = '#0f0';
                marker.style.boxShadow = '0 0 10px #0f0';
            }
        }
        
        // 提取进度管理
        function startExtraction() {
            const progressBar = document.getElementById('extractionProgress');
            const progressFill = document.getElementById('progressFill');
            
            progressBar.style.display = 'block';
            appState.extractionProgress = 0;
            appState.extractionComplete = false;
            
            const extractionInterval = setInterval(() => {
                if (!appState.isRunning) return;
                
                appState.extractionProgress += Math.random() * 3;
                progressFill.style.width = appState.extractionProgress + '%';
                
                // 随机污染事件
                if (Math.random() > 0.95) {
                    updateContaminationLevel(Math.random() * 10);
                }
                
                if (appState.extractionProgress >= 100) {
                    clearInterval(extractionInterval);
                    completeExtraction();
                }
            }, 100);
        }
        
        // 完成提取
        function completeExtraction() {
            appState.extractionComplete = true;
            playSuccessSound();
            vibrate([50, 100, 50]);
            
            // 生成结果数据
            const resultData = generateExtractionResults();
            displayResults(resultData);
            
            // 隐藏进度条
            setTimeout(() => {
                document.getElementById('extractionProgress').style.display = 'none';
                appState.extractionProgress = 0;
            }, 1000);
        }
        
        // 生成提取结果
        function generateExtractionResults() {
            const selectedBases = appState.selectedDNA.length || Math.floor(Math.random() * 20 + 10);
            const purity = (100 - appState.contaminationLevel).toFixed(2);
            const sequences = [];
            
            for (let i = 0; i < 5; i++) {
                const seq = Array(20).fill(0).map(() => 
                    ['A','T','C','G'][Math.floor(Math.random() * 4)]
                ).join('');
                sequences.push(seq);
            }
            
            return {
                timestamp: new Date().toISOString(),
                extractionId: 'GEN-' + Math.random().toString(36).substr(2, 9).toUpperCase(),
                samplesAnalyzed: selectedBases,
                purity: purity + '%',
                contaminationLevel: appState.contaminationLevel.toFixed(2) + '%',
                sequences: sequences,
                mutations: Math.floor(Math.random() * 10),
                viability: Math.random() > 0.5 ? 'VIABLE' : 'UNSTABLE'
            };
        }
        
        // 显示结果
        function displayResults(data) {
            const resultPanel = document.getElementById('resultPanel');
            const resultData = document.getElementById('resultData');
            
            resultData.innerHTML = `
EXTRACTION ID: ${data.extractionId}
TIMESTAMP: ${data.timestamp}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
SAMPLES ANALYZED: ${data.samplesAnalyzed}
PURITY: ${data.purity}
CONTAMINATION: ${data.contaminationLevel}
MUTATIONS DETECTED: ${data.mutations}
VIABILITY STATUS: ${data.viability}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
GENE SEQUENCES:
${data.sequences.map((seq, i) => `${i+1}. ${seq}`).join('\n')}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
STATUS: ${data.viability === 'VIABLE' ? '✓ READY FOR TRANSFER' : '✗ REQUIRES REPROCESSING'}
            `;
            
            resultPanel.style.display = 'block';
            showNotification('Extraction complete! Results available.', 'success');
        }
        
        // 关闭结果面板
        function closeResults() {
            document.getElementById('resultPanel').style.display = 'none';
            playClickSound();
        }

        // 黑洞引力场
        class BlackHole {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.mass = 100;
                this.radius = 50;
                this.active = true;
            }

            attract(particle) {
                if (!this.active) return { fx: 0, fy: 0 };
                
                const dx = this.x - particle.x;
                const dy = this.y - particle.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < this.radius) {
                    particle.absorbed = true;
                    return { fx: 0, fy: 0 };
                }
                
                const force = (this.mass * appState.blackholeIntensity) / (distance * distance);
                const fx = (dx / distance) * force;
                const fy = (dy / distance) * force;
                
                return { fx, fy };
            }

            draw() {
                if (!this.active) return;
                
                // 引力扭曲效果 - 红紫漩涡，增加发光
                const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.radius * 3);
                gradient.addColorStop(0, 'rgba(0,0,0,1)');
                gradient.addColorStop(0.2, 'rgba(80,0,40,0.8)');
                gradient.addColorStop(0.4, 'rgba(150,20,100,0.5)');
                gradient.addColorStop(0.6, 'rgba(100,0,80,0.3)');
                gradient.addColorStop(0.8, 'rgba(60,0,40,0.1)');
                gradient.addColorStop(1, 'transparent');
                
                ctx.fillStyle = gradient;
                ctx.fillRect(this.x - this.radius * 3, this.y - this.radius * 3, this.radius * 6, this.radius * 6);
                
                // 添加发光环 - 紫色
                ctx.strokeStyle = 'rgba(255,100,255,0.3)';
                ctx.lineWidth = 2;
                ctx.shadowBlur = 30;
                ctx.shadowColor = 'rgba(200,0,255,0.5)';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius * 1.5, 0, Math.PI * 2);
                ctx.stroke();
                ctx.shadowBlur = 0;
            }
        }

        const blackhole = new BlackHole(width / 2, height / 2);

        // 增强粒子类
        class EnhancedParticle {
            constructor() {
                this.reset();
                this.trail = [];
                this.maxTrailLength = 10;
            }

            reset() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = (Math.random() - 0.5) * 2;
                this.size = Math.random() * 3 + 1;
                this.life = 1;
                this.decay = Math.random() * 0.005 + 0.003;
                // 红紫色系粒子
                const colorChoice = Math.random();
                if (colorChoice < 0.45) {
                    // 血红色粒子
                    this.color = `hsl(${350 + Math.random() * 20}, 100%, ${35 + Math.random() * 30}%)`;
                } else if (colorChoice < 0.8) {
                    // 紫色粒子
                    this.color = `hsl(${280 + Math.random() * 40}, 90%, ${40 + Math.random() * 25}%)`;
                } else {
                    // 深粉色粒子（红紫过渡）
                    this.color = `hsl(${320 + Math.random() * 30}, 85%, ${45 + Math.random() * 20}%)`;
                }
                this.absorbed = false;
                this.mass = Math.random() * 0.5 + 0.5;
            }

            update() {
                // 记录轨迹
                this.trail.push({ x: this.x, y: this.y });
                if (this.trail.length > this.maxTrailLength) {
                    this.trail.shift();
                }

                // 黑洞引力
                const force = blackhole.attract(this);
                this.vx += force.fx * this.mass;
                this.vy += force.fy * this.mass;

                // 鼠标交互
                if (mouse.isPressed) {
                    const dx = mouse.x - this.x;
                    const dy = mouse.y - this.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < 100) {
                        this.vx += (dx / distance) * 0.5;
                        this.vy += (dy / distance) * 0.5;
                    }
                }

                // 更新位置
                this.x += this.vx;
                this.y += this.vy;
                this.life -= this.decay;

                // 速度阻尼
                this.vx *= 0.99;
                this.vy *= 0.99;

                // 边界检测
                if (this.x < 0 || this.x > width || this.y < 0 || this.y > height || this.life <= 0 || this.absorbed) {
                    this.reset();
                    this.trail = [];
                }
            }

            draw() {
                // 绘制轨迹
                ctx.strokeStyle = this.color;
                ctx.lineWidth = this.size * 0.5;
                ctx.globalAlpha = this.life * 0.3;
                
                if (this.trail.length > 1) {
                    ctx.beginPath();
                    ctx.moveTo(this.trail[0].x, this.trail[0].y);
                    for (let i = 1; i < this.trail.length; i++) {
                        ctx.lineTo(this.trail[i].x, this.trail[i].y);
                    }
                    ctx.stroke();
                }

                // 绘制粒子
                ctx.globalAlpha = this.life;
                ctx.fillStyle = this.color;
                ctx.shadowBlur = 20;
                ctx.shadowColor = this.color;
                
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.shadowBlur = 0;
                ctx.globalAlpha = 1;
            }
        }

        // 创建粒子系统
        const particles = [];
        const particleCount = Math.floor(150 * appState.particleDensity);
        for (let i = 0; i < particleCount; i++) {
            particles.push(new EnhancedParticle());
        }

        // DNA螺旋增强版 - 多形态变化
        class DNAHelix {
            constructor() {
                this.points = [];
                this.numPoints = 100;
                this.rotation = 0;
                this.formMorphTimer = 0;
                this.currentForm = 'dna'; // dna, virus, corrupted, encrypted, stolen
                this.nextForm = 'virus';
                this.formTransition = 0;
                this.transitionProgress = 0; // 0-1的过渡进度
                this.transitionDuration = 10000; // 10秒切换一次形态
                this.morphDuration = 2000; // 2秒形态过渡动画
                this.virusSpikes = [];
                this.corruptedFragments = [];
                this.encryptedBlocks = [];
                this.stolenData = [];
                this.generatePoints();
                this.initializeForms();
            }

            generatePoints() {
                this.points = [];
                for (let i = 0; i < this.numPoints; i++) {
                    const t = (i / this.numPoints) * Math.PI * 4;
                    this.points.push({
                        angle: t,
                        radius: 100,
                        height: (i / this.numPoints - 0.5) * height
                    });
                }
            }

            initializeForms() {
                // 初始化病毒刺突 - 代表入侵的基因病毒
                for (let i = 0; i < this.numPoints * 2; i++) {
                    this.virusSpikes.push({
                        angle: Math.random() * Math.PI * 2,
                        length: 5 + Math.random() * 20,
                        infected: Math.random() > 0.7,
                        pulseSpeed: 0.5 + Math.random() * 1.5,
                        color: Math.random() > 0.5 ? 'red' : 'purple'
                    });
                }

                // 初始化损坏片段 - 代表被破坏的基因序列
                for (let i = 0; i < this.numPoints / 2; i++) {
                    this.corruptedFragments.push({
                        offset: Math.random() * 50 - 25,
                        rotation: Math.random() * Math.PI,
                        glitchIntensity: 0.3 + Math.random() * 0.7,
                        breakPoint: Math.random() > 0.5,
                        flickerSpeed: 1 + Math.random() * 3
                    });
                }

                // 初始化加密块 - 代表被加密保护的偷取数据
                for (let i = 0; i < this.numPoints / 4; i++) {
                    this.encryptedBlocks.push({
                        size: 10 + Math.random() * 15,
                        cipher: Math.floor(Math.random() * 16777215).toString(16),
                        decryptProgress: 0,
                        glowPhase: Math.random() * Math.PI * 2,
                        locked: Math.random() > 0.3
                    });
                }

                // 初始化偷取数据流 - 代表正在传输的基因数据
                for (let i = 0; i < this.numPoints; i++) {
                    this.stolenData.push({
                        value: Math.random(),
                        transferSpeed: 0.5 + Math.random() * 2,
                        packet: Math.random() > 0.8,
                        intercepted: Math.random() > 0.9,
                        trail: []
                    });
                }
            }

            update(time) {
                this.rotation = time * 0.5;
                this.formMorphTimer += 16; // ~60fps
                
                // 形态切换逻辑 - 平滑过渡
                if (this.formMorphTimer >= this.transitionDuration) {
                    this.formMorphTimer = 0;
                    
                    // 开始形态过渡
                    const forms = ['dna', 'virus', 'corrupted', 'encrypted', 'stolen'];
                    const currentIndex = forms.indexOf(this.currentForm);
                    this.currentForm = this.nextForm;
                    this.nextForm = forms[(currentIndex + 1) % forms.length];
                    this.transitionProgress = 0;
                }
                
                // 计算平滑过渡进度
                if (this.formMorphTimer < this.morphDuration) {
                    this.transitionProgress = this.formMorphTimer / this.morphDuration;
                    // 使用缓动函数使过渡更平滑
                    this.transitionProgress = this.easeInOutCubic(this.transitionProgress);
                } else {
                    this.transitionProgress = 1;
                }
                
                // 动态变形 - 根据形态调整
                for (let i = 0; i < this.numPoints; i++) {
                    let baseRadius = 100;
                    
                    // 根据当前形态调整基础半径
                    switch(this.currentForm) {
                        case 'virus':
                            baseRadius = 90 + Math.sin(time * 3 + i * 0.2) * 15;
                            break;
                        case 'corrupted':
                            baseRadius = 100 + (Math.random() - 0.5) * 20 * this.corruptedFragments[i % this.corruptedFragments.length].glitchIntensity;
                            break;
                        case 'encrypted':
                            baseRadius = 95 + Math.floor(Math.sin(time * 2 + i * 0.15) * 3) * 5;
                            break;
                        case 'stolen':
                            baseRadius = 100 + Math.sin(time * 4 + i * 0.1) * 8;
                            break;
                        default:
                            baseRadius = 100 + Math.sin(time * 2 + i * 0.1) * 10;
                    }
                    
                    this.points[i].radius = baseRadius;
                }
            }

            easeInOutCubic(t) {
                return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
            }

            draw() {
                const centerX = width / 2;
                const centerY = height / 2;
                
                // 添加中心发光核心 - 根据形态调整颜色
                ctx.save();
                const coreColors = this.getCoreColors();
                const coreGradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, 150);
                coreGradient.addColorStop(0, coreColors.inner);
                coreGradient.addColorStop(0.2, coreColors.mid);
                coreGradient.addColorStop(0.4, coreColors.outer);
                coreGradient.addColorStop(0.6, coreColors.far);
                coreGradient.addColorStop(1, 'transparent');
                ctx.fillStyle = coreGradient;
                ctx.fillRect(centerX - 150, centerY - 150, 300, 300);
                
                // 添加脉动核心光点
                const pulseSize = 20 + Math.sin(this.rotation * 2) * 10;
                const pulseGradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, pulseSize);
                pulseGradient.addColorStop(0, coreColors.pulse);
                pulseGradient.addColorStop(0.3, coreColors.pulseGlow);
                pulseGradient.addColorStop(0.6, coreColors.pulseEdge);
                pulseGradient.addColorStop(1, 'transparent');
                ctx.fillStyle = pulseGradient;
                ctx.fillRect(centerX - pulseSize, centerY - pulseSize, pulseSize * 2, pulseSize * 2);
                ctx.restore();

                // 平滑过渡绘制 - 混合当前和下一个形态
                if (this.transitionProgress < 1 && this.transitionProgress > 0) {
                    // 绘制当前形态（渐隐）
                    ctx.save();
                    ctx.globalAlpha = 1 - this.transitionProgress;
                    this.drawCurrentForm(centerX, centerY);
                    ctx.restore();
                    
                    // 绘制过渡效果
                    this.drawTransitionEffect(centerX, centerY);
                    
                    // 绘制下一个形态（渐显）
                    ctx.save();
                    ctx.globalAlpha = this.transitionProgress;
                    const tempForm = this.currentForm;
                    this.currentForm = this.nextForm;
                    this.drawCurrentForm(centerX, centerY);
                    this.currentForm = tempForm;
                    ctx.restore();
                } else {
                    // 正常绘制当前形态
                    this.drawCurrentForm(centerX, centerY);
                }
                
                ctx.globalAlpha = 1;
                ctx.shadowBlur = 0;
            }

            drawCurrentForm(centerX, centerY) {
                switch(this.currentForm) {
                    case 'dna':
                        this.drawDNAForm(centerX, centerY);
                        break;
                    case 'virus':
                        this.drawVirusForm(centerX, centerY);
                        break;
                    case 'corrupted':
                        this.drawCorruptedForm(centerX, centerY);
                        break;
                    case 'encrypted':
                        this.drawEncryptedForm(centerX, centerY);
                        break;
                    case 'stolen':
                        this.drawStolenForm(centerX, centerY);
                        break;
                }
            }

            drawTransitionEffect(centerX, centerY) {
                // 过渡时的特殊效果 - 数据解构和重组
                ctx.save();
                ctx.globalAlpha = 0.3;
                
                // 绘制分解粒子
                for (let i = 0; i < 50; i++) {
                    const angle = (i / 50) * Math.PI * 2;
                    const radius = 100 + Math.sin(this.rotation * 2 + i) * 50 * this.transitionProgress;
                    const x = centerX + Math.cos(angle) * radius;
                    const y = centerY + Math.sin(angle) * radius;
                    
                    ctx.fillStyle = `rgba(${255 * this.transitionProgress}, ${100}, ${255 * (1 - this.transitionProgress)}, 0.5)`;
                    ctx.beginPath();
                    ctx.arc(x, y, 2 + this.transitionProgress * 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                ctx.restore();
            }

            getCoreColors() {
                switch(this.currentForm) {
                    case 'virus':
                        return {
                            inner: 'rgba(150,0,50,0.4)',
                            mid: 'rgba(200,0,100,0.3)',
                            outer: 'rgba(150,0,80,0.2)',
                            far: 'rgba(100,0,50,0.1)',
                            pulse: 'rgba(255,0,100,0.9)',
                            pulseGlow: 'rgba(200,50,150,0.6)',
                            pulseEdge: 'rgba(150,0,100,0.3)'
                        };
                    case 'corrupted':
                        return {
                            inner: 'rgba(255,50,0,0.4)',
                            mid: 'rgba(200,100,50,0.3)',
                            outer: 'rgba(150,50,0,0.2)',
                            far: 'rgba(100,30,0,0.1)',
                            pulse: 'rgba(255,100,0,0.9)',
                            pulseGlow: 'rgba(255,150,50,0.6)',
                            pulseEdge: 'rgba(200,100,0,0.3)'
                        };
                    case 'encrypted':
                        return {
                            inner: 'rgba(0,200,255,0.4)',
                            mid: 'rgba(0,150,200,0.3)',
                            outer: 'rgba(0,100,150,0.2)',
                            far: 'rgba(0,50,100,0.1)',
                            pulse: 'rgba(0,255,255,0.9)',
                            pulseGlow: 'rgba(100,200,255,0.6)',
                            pulseEdge: 'rgba(0,150,200,0.3)'
                        };
                    case 'stolen':
                        return {
                            inner: 'rgba(150,0,255,0.4)',
                            mid: 'rgba(100,0,200,0.3)',
                            outer: 'rgba(80,0,150,0.2)',
                            far: 'rgba(50,0,100,0.1)',
                            pulse: 'rgba(200,0,255,0.9)',
                            pulseGlow: 'rgba(150,50,255,0.6)',
                            pulseEdge: 'rgba(100,0,200,0.3)'
                        };
                    default: // dna
                        return {
                            inner: 'rgba(255,255,255,0.3)',
                            mid: 'rgba(255,200,200,0.2)',
                            outer: 'rgba(255,100,100,0.1)',
                            far: 'rgba(200,50,50,0.05)',
                            pulse: 'rgba(255,255,255,0.8)',
                            pulseGlow: 'rgba(255,100,200,0.5)',
                            pulseEdge: 'rgba(200,50,255,0.3)'
                        };
                }
            }

            drawDNAForm(centerX, centerY) {
                // 经典DNA双螺旋形态
                ctx.strokeStyle = appState.phase === 'extracting' ? '#ff3333' : 
                                 appState.phase === 'reacting' ? '#ff6666' : '#ff0000';
                ctx.lineWidth = 5;
                ctx.shadowBlur = 40;
                ctx.shadowColor = ctx.strokeStyle;
                ctx.globalAlpha = 1;
                
                // 第一条链
                ctx.beginPath();
                for (let i = 0; i < this.numPoints; i++) {
                    const point = this.points[i];
                    const x = centerX + Math.cos(point.angle + this.rotation) * point.radius;
                    const y = centerY + point.height * 0.5;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();

                // 第二条链
                ctx.strokeStyle = appState.phase === 'extracting' ? '#ff00ff' : 
                                 appState.phase === 'reacting' ? '#ff66ff' : '#cc00ff';
                ctx.beginPath();
                for (let i = 0; i < this.numPoints; i++) {
                    const point = this.points[i];
                    const x = centerX + Math.cos(point.angle + this.rotation + Math.PI) * point.radius;
                    const y = centerY + point.height * 0.5;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();

                // 连接线
                ctx.strokeStyle = '#ff8800';
                ctx.lineWidth = 2;
                ctx.globalAlpha = 0.8;
                ctx.shadowBlur = 15;
                
                for (let i = 0; i < this.numPoints; i += 5) {
                    const point = this.points[i];
                    const x1 = centerX + Math.cos(point.angle + this.rotation) * point.radius;
                    const y1 = centerY + point.height * 0.5;
                    const x2 = centerX + Math.cos(point.angle + this.rotation + Math.PI) * point.radius;
                    const y2 = centerY + point.height * 0.5;
                    
                    ctx.beginPath();
                    ctx.moveTo(x1, y1);
                    ctx.lineTo(x2, y2);
                    ctx.stroke();
                }
            }

            drawTentacleForm(centerX, centerY) {
                // 克苏鲁触手形态
                ctx.globalAlpha = 0.8;
                
                for (let tentacle = 0; tentacle < 3; tentacle++) {
                    const baseAngle = (tentacle / 3) * Math.PI * 2;
                    ctx.strokeStyle = `rgba(${100 + tentacle * 30}, 0, ${150 + tentacle * 20}, 0.9)`;
                    ctx.lineWidth = 12 - tentacle * 2;
                    ctx.shadowBlur = 30;
                    ctx.shadowColor = ctx.strokeStyle;
                    
                    ctx.beginPath();
                    for (let i = 0; i < this.numPoints; i++) {
                        const t = i / this.numPoints;
                        const node = this.tentacleNodes[i];
                        
                        // 触手扭动效果
                        const wiggleX = Math.sin(this.rotation * node.wiggleSpeed + t * 8) * node.wiggleAmplitude;
                        const wiggleY = Math.cos(this.rotation * node.wiggleSpeed + t * 6) * (node.wiggleAmplitude * 0.5);
                        
                        const radius = node.baseRadius * (1 - t * 0.3); // 触手变细
                        const angle = baseAngle + this.rotation * 0.3 + t * Math.PI * 4;
                        
                        const x = centerX + Math.cos(angle) * radius + wiggleX;
                        const y = centerY + this.points[i].height * 0.7 + wiggleY;
                        
                        if (i === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                        
                        // 触手吸盘
                        if (i % 8 === 0 && i > 10) {
                            ctx.save();
                            ctx.fillStyle = `rgba(${80 + tentacle * 20}, 0, ${100 + tentacle * 15}, 0.6)`;
                            ctx.beginPath();
                            ctx.arc(x, y, 3 + Math.sin(this.rotation + i) * 2, 0, Math.PI * 2);
                            ctx.fill();
                            ctx.restore();
                        }
                    }
                    ctx.stroke();
                }
            }

            drawFeatherForm(centerX, centerY) {
                // 堕天使羽毛形态
                ctx.globalAlpha = 0.7;
                
                // 主羽轴
                ctx.strokeStyle = 'rgba(220, 220, 255, 0.9)';
                ctx.lineWidth = 6;
                ctx.shadowBlur = 20;
                ctx.shadowColor = 'rgba(255, 255, 255, 0.5)';
                
                for (let feather = 0; feather < 2; feather++) {
                    const featherAngle = feather * Math.PI + this.rotation * 0.2;
                    
                    ctx.beginPath();
                    for (let i = 0; i < this.numPoints; i++) {
                        const t = i / this.numPoints;
                        const point = this.points[i];
                        
                        const x = centerX + Math.cos(featherAngle) * (point.radius * 0.3) + 
                                  Math.sin(this.rotation + t * 10) * 5;
                        const y = centerY + point.height * 0.8;
                        
                        if (i === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                    }
                    ctx.stroke();
                    
                    // 羽毛倒刺
                    for (let i = 0; i < this.numPoints; i += 3) {
                        const t = i / this.numPoints;
                        const point = this.points[i];
                        const barb = this.featherBarbs[i * 2 + feather];
                        
                        if (!barb) continue;
                        
                        const mainX = centerX + Math.cos(featherAngle) * (point.radius * 0.3);
                        const mainY = centerY + point.height * 0.8;
                        
                        ctx.save();
                        ctx.strokeStyle = `rgba(255, 255, 255, ${barb.opacity})`;
                        ctx.lineWidth = 2;
                        ctx.shadowBlur = 10;
                        
                        const barbAngle = featherAngle + Math.PI * 0.5 + Math.sin(this.rotation + i * barb.sway) * 0.3;
                        const barbX = mainX + Math.cos(barbAngle) * barb.length;
                        const barbY = mainY + Math.sin(barbAngle) * barb.length * 0.5;
                        
                        ctx.beginPath();
                        ctx.moveTo(mainX, mainY);
                        ctx.lineTo(barbX, barbY);
                        ctx.stroke();
                        ctx.restore();
                    }
                }
                
                // 飘落的羽毛碎片
                for (let i = 0; i < 20; i++) {
                    const floatX = centerX + Math.sin(this.rotation * 0.5 + i) * 200;
                    const floatY = centerY + Math.cos(this.rotation * 0.3 + i) * 150 + 
                                   Math.sin(this.rotation + i * 0.1) * 50;
                    
                    ctx.save();
                    ctx.fillStyle = `rgba(255, 255, 255, ${0.1 + Math.sin(this.rotation + i) * 0.1})`;
                    ctx.beginPath();
                    ctx.arc(floatX, floatY, 2 + Math.sin(this.rotation + i) * 1, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                }
            }

            drawCyberForm(centerX, centerY) {
                // 赛博朋克链条形态
                ctx.globalAlpha = 0.9;
                
                // 主数据流
                for (let stream = 0; stream < 2; stream++) {
                    const streamAngle = stream * Math.PI + this.rotation * 0.4;
                    
                    for (let i = 0; i < this.cyberSegments.length; i++) {
                        const segment = this.cyberSegments[i];
                        const t = i / this.cyberSegments.length;
                        
                        const pulsePhase = this.rotation + segment.pulsePhase;
                        const glowIntensity = segment.glowIntensity * (0.5 + Math.sin(pulsePhase) * 0.5);
                        
                        ctx.strokeStyle = `rgba(0, ${Math.floor(200 + glowIntensity * 55)}, 255, ${glowIntensity})`;
                        ctx.lineWidth = segment.width;
                        ctx.shadowBlur = 25;
                        ctx.shadowColor = ctx.strokeStyle;
                        
                        const segmentLength = this.numPoints / this.cyberSegments.length;
                        const startIdx = i * segmentLength;
                        const endIdx = Math.min(startIdx + segmentLength, this.numPoints - 1);
                        
                        ctx.beginPath();
                        for (let j = startIdx; j < endIdx; j++) {
                            const point = this.points[j];
                            const x = centerX + Math.cos(point.angle + streamAngle) * (point.radius * 0.8);
                            const y = centerY + point.height * 0.6;
                            
                            if (j === startIdx) {
                                ctx.moveTo(x, y);
                            } else {
                                ctx.lineTo(x, y);
                            }
                        }
                        ctx.stroke();
                        
                        // 数据包流动效果
                        if (Math.random() < 0.1) {
                            const dataX = centerX + Math.cos(streamAngle + this.rotation * 2) * 120;
                            const dataY = centerY + Math.sin(this.rotation * 3 + i) * 80;
                            
                            ctx.save();
                            ctx.fillStyle = 'rgba(0, 255, 255, 0.8)';
                            ctx.shadowBlur = 15;
                            ctx.shadowColor = 'rgba(0, 255, 255, 1)';
                            ctx.fillRect(dataX - 3, dataY - 3, 6, 6);
                            ctx.restore();
                        }
                    }
                }
                
                // 网格连接线
                ctx.strokeStyle = 'rgba(0, 150, 255, 0.3)';
                ctx.lineWidth = 1;
                ctx.shadowBlur = 5;
                
                for (let i = 0; i < this.numPoints; i += 10) {
                    const point1 = this.points[i];
                    const point2 = this.points[(i + 20) % this.numPoints];
                    
                    const x1 = centerX + Math.cos(point1.angle + this.rotation * 0.4) * (point1.radius * 0.8);
                    const y1 = centerY + point1.height * 0.6;
                    const x2 = centerX + Math.cos(point2.angle + this.rotation * 0.4 + Math.PI) * (point2.radius * 0.8);
                    const y2 = centerY + point2.height * 0.6;
                    
                    ctx.beginPath();
                    ctx.moveTo(x1, y1);
                    ctx.lineTo(x2, y2);
                    ctx.stroke();
                }
            }

            drawChainForm(centerX, centerY) {
                // 机械铁链形态
                ctx.globalAlpha = 0.8;
                
                for (let chain = 0; chain < 2; chain++) {
                    const chainAngle = chain * Math.PI + this.rotation * 0.1;
                    
                    for (let i = 0; i < this.chainLinks.length; i++) {
                        const link = this.chainLinks[i];
                        const t = i / this.chainLinks.length;
                        const linkIndex = Math.floor(i * (this.numPoints / this.chainLinks.length));
                        
                        if (linkIndex >= this.numPoints) continue;
                        
                        const point = this.points[linkIndex];
                        const swingOffset = Math.sin(this.rotation * 0.5 + i * link.swing) * 10;
                        
                        const x = centerX + Math.cos(point.angle + chainAngle) * (point.radius * 0.9) + swingOffset;
                        const y = centerY + point.height * 0.5;
                        
                        // 链环颜色 - 锈蚀效果
                        const rustRed = Math.floor(150 + link.rustLevel * 105);
                        const rustGreen = Math.floor(80 + link.rustLevel * 50);
                        const rustBlue = Math.floor(20 + link.rustLevel * 30);
                        
                        ctx.strokeStyle = `rgba(${rustRed}, ${rustGreen}, ${rustBlue}, 0.9)`;
                        ctx.lineWidth = link.thickness;
                        ctx.shadowBlur = 8;
                        ctx.shadowColor = 'rgba(200, 100, 50, 0.5)';
                        
                        // 绘制椭圆形链环
                        ctx.save();
                        ctx.translate(x, y);
                        ctx.rotate(point.angle + chainAngle);
                        
                        ctx.beginPath();
                        ctx.ellipse(0, 0, link.size * 0.6, link.size, 0, 0, Math.PI * 2);
                        ctx.stroke();
                        
                        // 链环内部阴影
                        ctx.strokeStyle = `rgba(${rustRed - 50}, ${rustGreen - 30}, ${rustBlue - 10}, 0.5)`;
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.ellipse(0, 0, link.size * 0.4, link.size * 0.8, 0, 0, Math.PI * 2);
                        ctx.stroke();
                        
                        ctx.restore();
                        
                        // 偶发火花效果
                        if (Math.random() < 0.03) {
                            ctx.save();
                            ctx.fillStyle = `rgba(255, ${200 + Math.random() * 55}, 0, 0.8)`;
                            ctx.shadowBlur = 10;
                            ctx.shadowColor = 'rgba(255, 150, 0, 1)';
                            
                            const sparkX = x + (Math.random() - 0.5) * link.size;
                            const sparkY = y + (Math.random() - 0.5) * link.size;
                            ctx.fillRect(sparkX - 1, sparkY - 1, 2, 2);
                            ctx.restore();
                        }
                    }
                }
            }

            drawVirusForm(centerX, centerY) {
                // 病毒入侵形态 - 代表基因病毒感染
                ctx.globalAlpha = 0.9;
                
                // 主病毒链
                ctx.strokeStyle = 'rgba(255, 0, 100, 0.8)';
                ctx.lineWidth = 6;
                ctx.shadowBlur = 30;
                ctx.shadowColor = 'rgba(255, 0, 100, 0.8)';
                
                // 绘制螺旋病毒主体
                ctx.beginPath();
                for (let i = 0; i < this.numPoints; i++) {
                    const point = this.points[i];
                    const spike = this.virusSpikes[i * 2];
                    
                    // 病毒式扭曲
                    const virusDistortion = Math.sin(this.rotation * 2 + i * 0.3) * 20;
                    const x = centerX + Math.cos(point.angle + this.rotation) * (point.radius + virusDistortion);
                    const y = centerY + point.height * 0.5;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                    
                    // 病毒刺突蛋白
                    if (i % 5 === 0 && spike) {
                        ctx.save();
                        const spikeLength = spike.length * (1 + Math.sin(this.rotation * spike.pulseSpeed) * 0.3);
                        
                        ctx.strokeStyle = spike.infected ? 'rgba(255, 0, 0, 0.7)' : 'rgba(200, 0, 100, 0.5)';
                        ctx.lineWidth = 2;
                        ctx.shadowBlur = 10;
                        
                        // 绘制刺突
                        for (let s = 0; s < 4; s++) {
                            const spikeAngle = (s / 4) * Math.PI * 2 + this.rotation;
                            const sx = x + Math.cos(spikeAngle) * spikeLength;
                            const sy = y + Math.sin(spikeAngle) * spikeLength;
                            
                            ctx.beginPath();
                            ctx.moveTo(x, y);
                            ctx.lineTo(sx, sy);
                            ctx.stroke();
                            
                            // 刺突末端
                            ctx.fillStyle = spike.infected ? 'rgba(255, 50, 50, 0.8)' : 'rgba(200, 50, 150, 0.6)';
                            ctx.beginPath();
                            ctx.arc(sx, sy, 3, 0, Math.PI * 2);
                            ctx.fill();
                        }
                        ctx.restore();
                    }
                }
                ctx.stroke();
                
                // 感染扩散效果
                ctx.save();
                ctx.globalAlpha = 0.3;
                ctx.fillStyle = 'rgba(255, 0, 100, 0.2)';
                for (let i = 0; i < 20; i++) {
                    const spread = Math.sin(this.rotation + i) * 150;
                    const x = centerX + Math.cos(i * 0.5 + this.rotation) * spread;
                    const y = centerY + Math.sin(i * 0.5 + this.rotation) * spread;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 5 + Math.sin(this.rotation * 2 + i) * 3, 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.restore();
            }

            drawCorruptedForm(centerX, centerY) {
                // 损坏基因形态 - 代表被破坏的基因序列
                ctx.globalAlpha = 0.8;
                
                // 绘制断裂的DNA链
                for (let chain = 0; chain < 2; chain++) {
                    const chainAngle = chain * Math.PI + this.rotation * 0.3;
                    
                    ctx.strokeStyle = 'rgba(255, 100, 0, 0.7)';
                    ctx.lineWidth = 4;
                    ctx.shadowBlur = 20;
                    ctx.shadowColor = 'rgba(255, 50, 0, 0.5)';
                    
                    // 断裂的链段
                    let isDrawing = true;
                    ctx.beginPath();
                    for (let i = 0; i < this.numPoints; i++) {
                        const point = this.points[i];
                        const fragment = this.corruptedFragments[i % this.corruptedFragments.length];
                        
                        // 随机断裂
                        if (fragment.breakPoint && Math.random() < 0.3) {
                            isDrawing = !isDrawing;
                        }
                        
                        // 故障偏移
                        const glitchX = (Math.random() - 0.5) * fragment.glitchIntensity * 30;
                        const glitchY = (Math.random() - 0.5) * fragment.glitchIntensity * 20;
                        
                        const x = centerX + Math.cos(point.angle + chainAngle) * point.radius + glitchX + fragment.offset;
                        const y = centerY + point.height * 0.5 + glitchY;
                        
                        if (isDrawing) {
                            if (i === 0 || !isDrawing) {
                                ctx.moveTo(x, y);
                            } else {
                                ctx.lineTo(x, y);
                            }
                        } else {
                            ctx.moveTo(x, y);
                        }
                        
                        // 断裂点火花
                        if (fragment.breakPoint && i % 10 === 0) {
                            ctx.save();
                            ctx.fillStyle = `rgba(255, ${100 + Math.random() * 155}, 0, ${fragment.glitchIntensity})`;
                            ctx.shadowBlur = 15;
                            ctx.shadowColor = 'rgba(255, 150, 0, 1)';
                            
                            for (let spark = 0; spark < 3; spark++) {
                                const sparkX = x + (Math.random() - 0.5) * 20;
                                const sparkY = y + (Math.random() - 0.5) * 20;
                                ctx.fillRect(sparkX - 1, sparkY - 1, 2, 2);
                            }
                            ctx.restore();
                        }
                    }
                    ctx.stroke();
                }
                
                // 错误数据碎片
                ctx.save();
                ctx.globalAlpha = 0.5;
                for (let i = 0; i < this.corruptedFragments.length; i++) {
                    const fragment = this.corruptedFragments[i];
                    const x = centerX + Math.cos(this.rotation + i) * (100 + fragment.offset);
                    const y = centerY + Math.sin(this.rotation + i) * 50;
                    
                    // 闪烁的错误代码
                    if (Math.sin(this.rotation * fragment.flickerSpeed) > 0) {
                        ctx.fillStyle = 'rgba(255, 50, 0, 0.6)';
                        ctx.font = '10px monospace';
                        ctx.fillText('ERR_' + Math.floor(Math.random() * 9999), x, y);
                    }
                }
                ctx.restore();
            }

            drawEncryptedForm(centerX, centerY) {
                // 加密基因形态 - 代表被加密保护的偷取数据
                ctx.globalAlpha = 0.9;
                
                // 主加密链
                for (let stream = 0; stream < 2; stream++) {
                    const streamAngle = stream * Math.PI + this.rotation * 0.4;
                    
                    // 绘制加密数据流
                    ctx.strokeStyle = 'rgba(0, 200, 255, 0.7)';
                    ctx.lineWidth = 3;
                    ctx.setLineDash([10, 5]); // 虚线表示加密
                    ctx.shadowBlur = 20;
                    ctx.shadowColor = 'rgba(0, 200, 255, 0.5)';
                    
                    ctx.beginPath();
                    for (let i = 0; i < this.numPoints; i++) {
                        const point = this.points[i];
                        const x = centerX + Math.cos(point.angle + streamAngle) * point.radius;
                        const y = centerY + point.height * 0.5;
                        
                        if (i === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                    }
                    ctx.stroke();
                    ctx.setLineDash([]); // 重置虚线
                    
                    // 加密块
                    for (let i = 0; i < this.encryptedBlocks.length; i++) {
                        const block = this.encryptedBlocks[i];
                        const blockIndex = Math.floor(i * (this.numPoints / this.encryptedBlocks.length));
                        if (blockIndex >= this.numPoints) continue;
                        
                        const point = this.points[blockIndex];
                        const x = centerX + Math.cos(point.angle + streamAngle) * point.radius;
                        const y = centerY + point.height * 0.5;
                        
                        // 绘制加密块
                        ctx.save();
                        const glowPhase = this.rotation + block.glowPhase;
                        const glowIntensity = 0.5 + Math.sin(glowPhase) * 0.5;
                        
                        ctx.fillStyle = block.locked ? 
                            `rgba(0, 100, 255, ${glowIntensity})` : 
                            `rgba(0, 255, 200, ${glowIntensity})`;
                        ctx.strokeStyle = 'rgba(0, 200, 255, 0.8)';
                        ctx.lineWidth = 2;
                        
                        ctx.fillRect(x - block.size/2, y - block.size/2, block.size, block.size);
                        ctx.strokeRect(x - block.size/2, y - block.size/2, block.size, block.size);
                        
                        // 加密文字
                        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
                        ctx.font = '8px monospace';
                        ctx.fillText(block.cipher.substring(0, 4), x - 10, y + 2);
                        
                        ctx.restore();
                    }
                }
            }

            drawStolenForm(centerX, centerY) {
                // 偷取传输形态 - 代表正在传输的基因数据
                ctx.globalAlpha = 0.9;
                
                // 数据流传输
                for (let stream = 0; stream < 2; stream++) {
                    const streamAngle = stream * Math.PI + this.rotation * 0.5;
                    
                    // 主传输链
                    ctx.strokeStyle = 'rgba(200, 0, 255, 0.6)';
                    ctx.lineWidth = 4;
                    ctx.shadowBlur = 25;
                    ctx.shadowColor = 'rgba(200, 0, 255, 0.5)';
                    
                    ctx.beginPath();
                    for (let i = 0; i < this.numPoints; i++) {
                        const point = this.points[i];
                        const data = this.stolenData[i];
                        
                        // 数据流动效果
                        const flowOffset = Math.sin(this.rotation * data.transferSpeed + i * 0.1) * 10;
                        const x = centerX + Math.cos(point.angle + streamAngle) * (point.radius + flowOffset);
                        const y = centerY + point.height * 0.5;
                        
                        if (i === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                        
                        // 数据包
                        if (data.packet && i % 8 === 0) {
                            ctx.save();
                            
                            if (data.intercepted) {
                                // 被拦截的数据包 - 红色警告
                                ctx.fillStyle = 'rgba(255, 0, 0, 0.8)';
                                ctx.strokeStyle = 'rgba(255, 100, 100, 0.9)';
                            } else {
                                // 正常传输的数据包
                                ctx.fillStyle = 'rgba(150, 0, 255, 0.7)';
                                ctx.strokeStyle = 'rgba(200, 100, 255, 0.9)';
                            }
                            
                            ctx.lineWidth = 2;
                            ctx.shadowBlur = 10;
                            
                            // 数据包形状
                            ctx.beginPath();
                            ctx.rect(x - 5, y - 5, 10, 10);
                            ctx.fill();
                            ctx.stroke();
                            
                            // 数据值
                            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                            ctx.font = '6px monospace';
                            ctx.fillText(Math.floor(data.value * 100).toString(16), x - 4, y + 2);
                            
                            ctx.restore();
                        }
                    }
                    ctx.stroke();
                }
                
                // 传输轨迹
                ctx.save();
                ctx.globalAlpha = 0.3;
                ctx.strokeStyle = 'rgba(150, 0, 255, 0.4)';
                ctx.lineWidth = 1;
                
                for (let i = 0; i < 30; i++) {
                    const trailX = centerX + Math.cos(this.rotation * 2 + i) * (80 + i * 3);
                    const trailY = centerY + Math.sin(this.rotation * 2 + i) * (40 + i * 2);
                    
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.lineTo(trailX, trailY);
                    ctx.stroke();
                }
                ctx.restore();
            }
        }

        const dnaHelix = new DNAHelix();

        // 流体动力学模拟
        class FluidField {
            constructor() {
                this.resolution = 20;
                this.cols = Math.ceil(width / this.resolution);
                this.rows = Math.ceil(height / this.resolution);
                this.field = [];
                this.init();
            }

            init() {
                for (let i = 0; i < this.cols; i++) {
                    this.field[i] = [];
                    for (let j = 0; j < this.rows; j++) {
                        this.field[i][j] = {
                            vx: 0,
                            vy: 0,
                            pressure: 0
                        };
                    }
                }
            }

            update(time) {
                // 更新流场
                for (let i = 0; i < this.cols; i++) {
                    for (let j = 0; j < this.rows; j++) {
                        const noise = Math.sin(time + i * 0.1) * Math.cos(time + j * 0.1);
                        this.field[i][j].vx = noise * 10;
                        this.field[i][j].vy = Math.cos(time + i * 0.1) * 10;
                        this.field[i][j].pressure = Math.sin(time * 2 + i * j * 0.01);
                    }
                }
            }

            draw() {
                ctx.strokeStyle = 'rgba(0,255,255,0.1)';
                ctx.lineWidth = 1;
                
                for (let i = 0; i < this.cols; i += 2) {
                    for (let j = 0; j < this.rows; j += 2) {
                        const x = i * this.resolution;
                        const y = j * this.resolution;
                        const cell = this.field[i][j];
                        
                        ctx.beginPath();
                        ctx.moveTo(x, y);
                        ctx.lineTo(x + cell.vx, y + cell.vy);
                        ctx.stroke();
                    }
                }
            }
        }

        const fluidField = new FluidField();

        // 波形生成器
        class WaveGenerator {
            constructor() {
                this.waves = [];
                for (let i = 0; i < 5; i++) {
                    this.waves.push({
                        amplitude: Math.random() * 30 + 10,
                        frequency: Math.random() * 0.02 + 0.005,
                        speed: Math.random() * 0.003 + 0.001,
                        offset: 0,
                        color: `hsla(${280 + Math.random() * 80}, 70%, ${25 + Math.random() * 20}%, 0.4)`
                    });
                }
            }

            update(deltaTime) {
                this.waves.forEach(wave => {
                    wave.offset += wave.speed * deltaTime;
                });
            }

            draw() {
                this.waves.forEach((wave, index) => {
                    ctx.strokeStyle = wave.color;
                    ctx.lineWidth = 2;
                    
                    ctx.beginPath();
                    for (let x = 0; x < width; x += 5) {
                        const y = height * 0.7 + Math.sin(x * wave.frequency + wave.offset) * wave.amplitude;
                        if (x === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                    }
                    ctx.stroke();
                });
            }
        }

        const waveGenerator = new WaveGenerator();

        // 创建波纹效果
        function createRipple(x, y) {
            const ripple = document.createElement('div');
            ripple.className = 'ripple';
            ripple.style.left = x - 100 + 'px';
            ripple.style.top = y - 100 + 'px';
            document.body.appendChild(ripple);
            
            setTimeout(() => ripple.remove(), 1000);
        }

        // 点击事件
        canvas.addEventListener('click', (e) => {
            createRipple(e.clientX, e.clientY);
            
            // 在点击位置创建粒子爆炸
            for (let i = 0; i < 10; i++) {
                const particle = new EnhancedParticle();
                particle.x = e.clientX;
                particle.y = e.clientY;
                particle.vx = (Math.random() - 0.5) * 10;
                particle.vy = (Math.random() - 0.5) * 10;
                particles.push(particle);
            }
        });

        // 键盘控制 - 空格键切换能量场（内部视觉效果）
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault(); // 防止页面滚动
                appState.blackholeActive = !appState.blackholeActive;
                blackhole.active = appState.blackholeActive;
                
                // 保持能量场状态但不显示相关文字
                // 黑洞效果作为纯视觉效果存在，不再有UI提示
            }
        });

        // 阶段切换
        function updatePhase() {
            const phases = ['extracting', 'reacting', 'transferring'];
            const currentIndex = phases.indexOf(appState.phase);
            const nextIndex = (currentIndex + 1) % phases.length;
            appState.phase = phases[nextIndex];
            appState.phaseTime = 0;

            // 更新UI
            document.querySelectorAll('.phase').forEach(el => el.classList.remove('active'));
            
            if (appState.phase === 'extracting') {
                document.getElementById('phase-extract').classList.add('active');
                updateContaminationLevel(-5); // 提取阶段降低污染
                showNotification('Extracting genetic material...', 'info');
            } else if (appState.phase === 'reacting') {
                document.getElementById('phase-react').classList.add('active');
                updateContaminationLevel(15); // 反应阶段增加污染
                
                // 触发警告
                if (Math.random() > 0.7) {
                    const biohazard = document.querySelector('[data-status="biohazard"] .status-light');
                    biohazard.className = 'status-light error';
                    setTimeout(() => {
                        biohazard.className = 'status-light warning';
                    }, 2000);
                    
                    if (appState.contaminationLevel > 50) {
                        triggerBiohazardWarning();
                    }
                }
                showNotification('Chemical reaction in progress...', 'info');
            } else if (appState.phase === 'transferring') {
                document.getElementById('phase-transfer').classList.add('active');
                updateContaminationLevel(-10); // 转移阶段清理污染
                showNotification('Transferring to storage...', 'info');
            }
            
            playTone(300 + currentIndex * 100, 0.1);
        }

        // 手动阶段切换
        document.querySelectorAll('.phase').forEach(phase => {
            phase.addEventListener('click', function() {
                appState.phase = this.dataset.phase;
                appState.phaseTime = 0;
                document.querySelectorAll('.phase').forEach(el => el.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // 监控数据更新
        function updateMonitorData() {
            // 更新新模块数据
            updateIllegalGeneModules();
        }

        // 更新非法基因采集模块
        function updateIllegalGeneModules() {
            // 样本编号故障效果
            if (Math.random() < 0.05) {
                const sampleId = document.getElementById('sample-id');
                const corrupted = ['SRC-0823-XF', 'SRC-0█23-XF', 'S█C-0823-█F', 'SRC-08██-XF'];
                sampleId.textContent = corrupted[Math.floor(Math.random() * corrupted.length)];
                setTimeout(() => {
                    sampleId.textContent = 'SRC-0823-XF';
                }, 200);
            }

            // 采集进度更新
            const progressFill = document.getElementById('collection-fill');
            const progressText = document.getElementById('collection-percent');
            const progress = 73 + Math.sin(appState.time * 0.2) * 5;
            progressFill.style.height = Math.max(0, Math.min(100, progress)) + '%';
            progressText.textContent = Math.floor(progress) + '%';

            // 纯度等级更新
            const purityValue = document.getElementById('purity-value');
            const purityRing = document.getElementById('purity-ring');
            const purity = 94.2 + Math.sin(appState.time * 0.3) * 2 + Math.random() * 1;
            purityValue.textContent = purity.toFixed(1) + '%';
            const circumference = 2 * Math.PI * 25;
            const offset = circumference - (purity / 100) * circumference;
            purityRing.style.strokeDashoffset = offset;

            // 活性评分更新
            const activityScore = document.getElementById('activity-score');
            const score = 9.4 + Math.sin(appState.time * 0.8) * 0.3 + Math.random() * 0.2;
            activityScore.textContent = score.toFixed(1);

            // 核苷酸链长度更新
            const chainValue = document.getElementById('chain-value');
            const length = 3.2 + Math.sin(appState.time * 0.1) * 0.1;
            chainValue.textContent = length.toFixed(1) + 'M';

            // 黑市价格波动
            const marketPrice = document.getElementById('market-price');
            const basePrice = 48300;
            const fluctuation = Math.sin(appState.time * 0.05) * 2000 + Math.random() * 1000 - 500;
            const price = Math.floor(basePrice + fluctuation);
            marketPrice.textContent = price.toLocaleString();

            // 样本状态随机切换
            if (Math.random() < 0.02) {
                const statusIndicator = document.getElementById('status-indicator');
                const statusText = document.getElementById('status-text');
                const states = [
                    { text: '活性', class: 'active', color: '#00ff00' },
                    { text: '冷冻', class: 'frozen', color: '#0088ff' },
                    { text: '降解中', class: 'degrading', color: '#ff8800' }
                ];
                const state = states[Math.floor(Math.random() * states.length)];
                statusText.textContent = state.text;
                statusIndicator.className = 'status-light ' + state.class;
                statusIndicator.style.background = state.color;
                statusIndicator.style.boxShadow = `0 0 8px ${state.color}`;
            }

            // 风险级别随机变化
            if (Math.random() < 0.01) {
                const riskIndicator = document.getElementById('risk-indicator');
                const risks = [
                    { level: 'low', text: 'LOW', color: '#00ff00' },
                    { level: 'medium', text: 'MEDIUM', color: '#ff9900' },
                    { level: 'high', text: 'HIGH', color: '#ff0000' }
                ];
                const risk = risks[Math.floor(Math.random() * risks.length)];
                riskIndicator.className = 'risk-indicator ' + risk.level;
                riskIndicator.querySelector('.risk-text').textContent = risk.text;
                riskIndicator.style.borderColor = risk.color;
                riskIndicator.style.color = risk.color;
            }
        }

        // 监控项点击效果
        document.querySelectorAll('.monitor-item').forEach(item => {
            item.addEventListener('click', function() {
                const type = this.dataset.type;
                console.log(`Monitor clicked: ${type}`);
                
                // 创建数据波动
                const value = this.querySelector('.monitor-value span');
                value.style.color = '#ff0';
                setTimeout(() => {
                    value.style.color = '#0ff';
                }, 500);
            });
        });

        // 控制按钮
        document.getElementById('btn-start').addEventListener('click', function() {
            playClickSound();
            vibrate([30]);
            
            if (!appState.isRunning) {
                appState.isRunning = true;
                this.classList.add('active');
                document.getElementById('btn-pause').classList.remove('active');
                showNotification('System started', 'success');
                
                // 开始提取过程
                if (!appState.extractionComplete && appState.extractionProgress === 0) {
                    startExtraction();
                }
            } else if (appState.extractionProgress === 0) {
                // 如果系统已运行但未开始提取，则开始提取
                startExtraction();
                showNotification('DNA extraction initiated', 'info');
            }
        });

        document.getElementById('btn-pause').addEventListener('click', function() {
            playClickSound();
            vibrate([30]);
            
            appState.isRunning = false;
            this.classList.add('active');
            document.getElementById('btn-start').classList.remove('active');
            
            // 显示暂停界面
            showPauseOverlay();
        });

        document.getElementById('btn-reset').addEventListener('click', () => {
            playClickSound();
            vibrate([50, 30, 50]);
            
            // 确认重置
            if (appState.extractionProgress > 0 && !confirm('Reset will lose current extraction progress. Continue?')) {
                return;
            }
            
            // 重置所有状态
            appState.phase = 'extracting';
            appState.phaseTime = 0;
            appState.time = 0;
            appState.extractionProgress = 0;
            appState.extractionComplete = false;
            appState.contaminationLevel = 10;
            appState.selectedDNA = [];
            
            updatePhase();
            updateContaminationLevel(0);
            
            // 隐藏所有面板
            document.getElementById('extractionProgress').style.display = 'none';
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('resultPanel').style.display = 'none';
            document.getElementById('biohazardWarning').style.display = 'none';
            
            // 重置所有粒子
            particles.forEach(p => p.reset());
            
            // 重置DNA序列选择
            document.querySelectorAll('.base-pair.selected').forEach(el => {
                el.classList.remove('selected');
            });
            
            showNotification('System reset complete', 'success');
        });

        // 滑块控制 - 基因分析参数
        document.getElementById('complexity-slider').addEventListener('input', function() {
            appState.geneComplexity = this.value / 100;
            document.getElementById('complexity-value').textContent = this.value + '%';
            // DNA序列显示已被移除
            // generateDNASequence();
        });

        document.getElementById('mutation-slider').addEventListener('input', function() {
            appState.mutationRate = this.value / 100;
            document.getElementById('mutation-value').textContent = this.value + '%';
            // 影响粒子颜色变化和DNA变异显示
            
            // 调整粒子数量
            const targetCount = Math.floor(150 * appState.particleDensity);
            while (particles.length < targetCount) {
                particles.push(new EnhancedParticle());
            }
            while (particles.length > targetCount) {
                particles.pop();
            }
        });

        // DNA序列生成和交互
        function generateDNASequence() {
            // DNA显示已被移除，跳过此函数
            const display = document.getElementById('dna-display');
            if (!display) return;
            
            // 基因复杂度影响序列长度和变异
            const sequenceLength = Math.floor(30 + appState.geneComplexity * 40); // 30-70个碱基对
            
            for (let i = 0; i < sequenceLength; i++) {
                // 复杂度影响碱基对的多样性
                const useComplexPattern = Math.random() < appState.geneComplexity;
                const group = useComplexPattern 
                    ? bases.sort(() => Math.random() - 0.5).join('')
                    : bases[Math.floor(Math.random() * 4)].repeat(4);
                    
                const span = document.createElement('span');
                span.className = 'base-pair';
                
                // 突变率影响显示
                if (Math.random() < appState.mutationRate) {
                    span.className += ' mutation';
                    span.style.color = `hsl(${280 + Math.random() * 80}, 100%, 60%)`;
                }
                
                span.textContent = group;
                span.dataset.index = i;
                
                span.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    
                    if (this.classList.contains('selected')) {
                        appState.selectedDNA.push(i);
                    } else {
                        appState.selectedDNA = appState.selectedDNA.filter(idx => idx !== i);
                    }
                    
                    console.log('Selected DNA indices:', appState.selectedDNA);
                });
                
                display.appendChild(span);
            }
        }

        // 全屏功能
        document.getElementById('fullscreenBtn').addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        });

        // 音频可视化
        function createAudioVisualizer() {
            const visualizer = document.getElementById('audioVisualizer');
            for (let i = 0; i < 50; i++) {
                const bar = document.createElement('div');
                bar.className = 'audio-bar';
                bar.style.animationDelay = `${i * 0.05}s`;
                bar.style.animationDuration = `${1 + Math.random()}s`;
                visualizer.appendChild(bar);
            }
        }

        // 显示交互提示
        setTimeout(() => {
            const hint = document.getElementById('interactionHint');
            hint.classList.add('show');
            setTimeout(() => {
                hint.classList.remove('show');
            }, 5000);
        }, 3000);

        // 主动画循环
        let lastTime = 0;
        function animate(currentTime) {
            const deltaTime = currentTime - lastTime;
            lastTime = currentTime;

            // 清除画布 - 更亮的背景
            ctx.fillStyle = 'rgba(20, 10, 5, 0.04)';
            ctx.fillRect(0, 0, width, height);
            
            // 添加更强的环境光
            const ambientGradient = ctx.createRadialGradient(width/2, height/2, 0, width/2, height/2, width/2);
            ambientGradient.addColorStop(0, 'rgba(150,50,50,0.1)');
            ambientGradient.addColorStop(0.3, 'rgba(100,30,30,0.07)');
            ambientGradient.addColorStop(0.6, 'rgba(80,20,20,0.04)');
            ambientGradient.addColorStop(1, 'rgba(0,0,0,0)');
            ctx.fillStyle = ambientGradient;
            ctx.fillRect(0, 0, width, height);
            
            // 添加顶部高光
            const topLight = ctx.createLinearGradient(0, 0, 0, height/3);
            topLight.addColorStop(0, 'rgba(255,100,100,0.08)');
            topLight.addColorStop(1, 'transparent');
            ctx.fillStyle = topLight;
            ctx.fillRect(0, 0, width, height/3);

            if (appState.isRunning) {
                appState.time += deltaTime * 0.001;
                appState.phaseTime += deltaTime;

                if (appState.phaseTime >= appState.phaseDuration) {
                    updatePhase();
                }

                // 更新和绘制流场
                fluidField.update(appState.time);
                fluidField.draw();

                // 更新和绘制波形
                waveGenerator.update(deltaTime);
                waveGenerator.draw();

                // 绘制黑洞
                blackhole.draw();

                // 更新和绘制DNA螺旋
                dnaHelix.update(appState.time);
                dnaHelix.draw();

                // 更新和绘制粒子
                particles.forEach(particle => {
                    particle.update();
                    particle.draw();
                });

                // 更新监控数据
                if (Math.floor(appState.time * 10) % 5 === 0) {
                    updateMonitorData();
                }
                
                // 添加有机脉动效果
                const pulseIntensity = Math.sin(appState.time * 2) * 0.5 + 0.5;
                
                // 脉动光源
                ctx.save();
                const pulseGradient = ctx.createRadialGradient(
                    width * 0.3, height * 0.3, 0,
                    width * 0.3, height * 0.3, 200
                );
                pulseGradient.addColorStop(0, `rgba(255,50,50,${pulseIntensity * 0.2})`);
                pulseGradient.addColorStop(0.5, `rgba(200,30,30,${pulseIntensity * 0.1})`);
                pulseGradient.addColorStop(1, 'transparent');
                ctx.fillStyle = pulseGradient;
                ctx.fillRect(0, 0, width, height);
                
                // 第二个脉动光源 - 紫色
                const pulseGradient2 = ctx.createRadialGradient(
                    width * 0.7, height * 0.6, 0,
                    width * 0.7, height * 0.6, 150
                );
                pulseGradient2.addColorStop(0, `rgba(200,50,255,${(1 - pulseIntensity) * 0.15})`);
                pulseGradient2.addColorStop(0.5, `rgba(150,0,200,${(1 - pulseIntensity) * 0.08})`);
                pulseGradient2.addColorStop(1, 'transparent');
                ctx.fillStyle = pulseGradient2;
                ctx.fillRect(0, 0, width, height);
                ctx.restore();
                
                // 有机纹理叠加
                if (Math.random() > 0.98) {
                    ctx.strokeStyle = `rgba(200,0,0,${Math.random() * 0.3})`;
                    ctx.lineWidth = Math.random() * 3 + 1;
                    ctx.beginPath();
                    ctx.moveTo(Math.random() * width, 0);
                    ctx.quadraticCurveTo(
                        width / 2 + (Math.random() - 0.5) * 200,
                        height / 2 + (Math.random() - 0.5) * 200,
                        Math.random() * width,
                        height
                    );
                    ctx.stroke();
                }
            }

            requestAnimationFrame(animate);
        }

        // 窗口调整
        window.addEventListener('resize', () => {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            blackhole.x = width / 2;
            blackhole.y = height / 2;
            fluidField.cols = Math.ceil(width / fluidField.resolution);
            fluidField.rows = Math.ceil(height / fluidField.resolution);
            fluidField.init();
        });

        // 初始化
        // generateDNASequence(); // DNA显示已被移除
        // setInterval(generateDNASequence, 10000); // DNA显示已被移除
        createAudioVisualizer();
        
        // 初始化污染等级
        updateContaminationLevel(0);
        
        // 添加音频开关快捷键
        document.addEventListener('keydown', (e) => {
            if (e.key === 'a' || e.key === 'A') {
                appState.audioEnabled = !appState.audioEnabled;
                if (appState.audioEnabled) {
                    // 解锁音频上下文
                    audioContext.resume();
                    showNotification('Audio enabled', 'success');
                    playSuccessSound();
                } else {
                    showNotification('Audio disabled', 'info');
                }
            }
        });
        
        // 添加数字键快速切换阶段
        document.addEventListener('keydown', (e) => {
            if (e.key === '1') {
                appState.phase = 'extracting';
                document.querySelectorAll('.phase').forEach(el => el.classList.remove('active'));
                document.getElementById('phase-extract').classList.add('active');
                showNotification('Phase: Extracting', 'info');
            } else if (e.key === '2') {
                appState.phase = 'reacting';
                document.querySelectorAll('.phase').forEach(el => el.classList.remove('active'));
                document.getElementById('phase-react').classList.add('active');
                showNotification('Phase: Reacting', 'info');
            } else if (e.key === '3') {
                appState.phase = 'transferring';
                document.querySelectorAll('.phase').forEach(el => el.classList.remove('active'));
                document.getElementById('phase-transfer').classList.add('active');
                showNotification('Phase: Transferring', 'info');
            }
        });
        
        // 监控污染等级变化
        setInterval(() => {
            if (appState.isRunning && appState.phase === 'reacting') {
                // 反应阶段缓慢增加污染
                updateContaminationLevel(Math.random() * 2);
            } else if (appState.isRunning && appState.phase === 'transferring') {
                // 转移阶段缓慢降低污染
                updateContaminationLevel(-Math.random() * 1);
            }
        }, 2000);

        // 隐藏加载屏幕
        setTimeout(() => {
            const loadingScreen = document.getElementById('loadingScreen');
            loadingScreen.style.opacity = '0';
            setTimeout(() => {
                loadingScreen.style.display = 'none';
                // 显示操作提示
                showNotification('Welcome to Gene Thief v2.0 | Press A for audio | Press SPACE for black hole', 'info');
            }, 1000);
        }, 2000);

        // 暂停菜单按钮事件
        document.getElementById('resumeBtn').addEventListener('click', () => {
            playClickSound();
            hidePauseOverlay();
            document.getElementById('btn-pause').classList.remove('active');
            document.getElementById('btn-start').classList.add('active');
        });
        
        document.getElementById('saveBtn').addEventListener('click', () => {
            playClickSound();
            // 保存进度功能
            const saveData = {
                phase: appState.phase,
                time: appState.time,
                genes: appState.selectedDNA,
                contamination: appState.contaminationLevel,
                complexity: appState.geneComplexity,
                mutationRate: appState.mutationRate,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('geneThiefSave', JSON.stringify(saveData));
            showNotification('Progress saved successfully', 'success');
            
            // 显示保存动画
            const btn = document.getElementById('saveBtn');
            btn.style.background = 'linear-gradient(135deg, rgba(0,150,0,0.8) 0%, rgba(0,100,0,0.8) 100%)';
            setTimeout(() => {
                btn.style.background = '';
            }, 1000);
        });
        
        document.getElementById('settingsBtn').addEventListener('click', () => {
            playClickSound();
            showNotification('Settings panel coming soon', 'info');
        });
        
        document.getElementById('abortBtn').addEventListener('click', () => {
            playWarningSound();
            vibrate([100, 50, 100]);
            
            if (confirm('WARNING: Abort current extraction? All progress will be lost!')) {
                // 重置所有状态
                appState.phase = 'extracting';
                appState.time = 0;
                appState.selectedDNA = [];
                appState.extractionProgress = 0;
                appState.contaminationLevel = 10;
                appState.extractionComplete = false;
                
                // 隐藏暂停界面
                hidePauseOverlay();
                
                // 重置UI
                document.getElementById('btn-pause').classList.remove('active');
                document.getElementById('btn-start').classList.remove('active');
                document.getElementById('btn-reset').click();
                
                showNotification('Mission aborted', 'error');
            }
        });
        
        // ESC键也可以恢复
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && document.getElementById('pauseOverlay').classList.contains('active')) {
                hidePauseOverlay();
                document.getElementById('btn-pause').classList.remove('active');
                document.getElementById('btn-start').classList.add('active');
            }
        });
        
        // 启动动画
        animate(0);

        console.log('Gene Thief Advanced Visualization System Initialized');
        console.log('Controls:');
        console.log('- SPACE: Toggle black hole');
        console.log('- A: Toggle audio');
        console.log('- 1/2/3: Switch phases');
        console.log('- Click: Create particle explosions');
        console.log('- Drag: Influence particles');
        console.log('- START button: Begin DNA extraction');
    </script>
</body>
</html>
